

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Program Listing for File Games.cpp &mdash; EPECSolve 2.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/collapsible-lists/js/CollapsibleLists.compressed.js"></script>
        <script src="../_static/collapsible-lists/js/apply-collapsible-lists.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/collapsible-lists/css/tree_view.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> EPECSolve
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Quick Start</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Welcome</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../index.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#license">LICENSE</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../support_files/compiling.html">Compiling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../support_files/compiling.html#cmake">CMake</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../support_files/command_line.html">Command-line interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../support_files/EPEC.html">EPEC Example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../support_files/EPEC.html#u-v-player">u-v player</a></li>
<li class="toctree-l4"><a class="reference internal" href="../support_files/EPEC.html#x-y-player">x-y player</a></li>
<li class="toctree-l4"><a class="reference internal" href="../support_files/EPEC.html#nash-equilibrium">Nash Equilibrium</a></li>
<li class="toctree-l4"><a class="reference internal" href="../support_files/EPEC.html#modeling-the-problem">Modeling the problem</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../support_files/LCP.html">LCP Example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../support_files/LCP.html#modeling-the-problem">Modeling the problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../support_files/LCP.html#solving">Solving</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../support_files/NashLCP.html">Nash LCP Example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../support_files/NashLCP.html#modeling-the-problem">Modeling the problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../support_files/NashLCP.html#checking-the-solution">Checking the solution</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../support_files/QP_Param.html">QP_Param Example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../support_files/QP_Param.html#modeling-the-problem">Modeling the problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../support_files/QP_Param.html#solving">Solving</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="namespace_Algorithms.html">Namespace Algorithms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="namespace_Algorithms.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="namespace_Game.html">Namespace Game</a><ul>
<li class="toctree-l4"><a class="reference internal" href="namespace_Game.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="namespace_Game.html#enums">Enums</a></li>
<li class="toctree-l4"><a class="reference internal" href="namespace_Game.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="namespace_Game.html#typedefs">Typedefs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="namespace_Models.html">Namespace Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="namespace_Models.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="namespace_Models.html#enums">Enums</a></li>
<li class="toctree-l4"><a class="reference internal" href="namespace_Models.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="namespace_Models.html#typedefs">Typedefs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="namespace_Utils.html">Namespace Utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="namespace_Utils.html#functions">Functions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../support_files/compiling.html">Compiling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../support_files/compiling.html#cmake">CMake</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../support_files/command_line.html">Command-line interface</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../support_files/EPEC.html">EPEC Example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../support_files/EPEC.html#u-v-player">u-v player</a></li>
<li class="toctree-l2"><a class="reference internal" href="../support_files/EPEC.html#x-y-player">x-y player</a></li>
<li class="toctree-l2"><a class="reference internal" href="../support_files/EPEC.html#nash-equilibrium">Nash Equilibrium</a></li>
<li class="toctree-l2"><a class="reference internal" href="../support_files/EPEC.html#modeling-the-problem">Modeling the problem</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../support_files/LCP.html">LCP Example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../support_files/LCP.html#modeling-the-problem">Modeling the problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../support_files/LCP.html#solving">Solving</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../support_files/NashLCP.html">Nash LCP Example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../support_files/NashLCP.html#modeling-the-problem">Modeling the problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../support_files/NashLCP.html#checking-the-solution">Checking the solution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../support_files/QP_Param.html">QP_Param Example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../support_files/QP_Param.html#modeling-the-problem">Modeling the problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../support_files/QP_Param.html#solving">Solving</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Quick References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="namespace_Algorithms.html">Namespace Algorithms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="namespace_Algorithms.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="namespace_Game.html">Namespace Game</a><ul>
<li class="toctree-l2"><a class="reference internal" href="namespace_Game.html#classes">Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="namespace_Game.html#enums">Enums</a></li>
<li class="toctree-l2"><a class="reference internal" href="namespace_Game.html#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="namespace_Game.html#typedefs">Typedefs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="namespace_Models.html">Namespace Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="namespace_Models.html#classes">Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="namespace_Models.html#enums">Enums</a></li>
<li class="toctree-l2"><a class="reference internal" href="namespace_Models.html#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="namespace_Models.html#typedefs">Typedefs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="namespace_Utils.html">Namespace Utils</a><ul>
<li class="toctree-l2"><a class="reference internal" href="namespace_Utils.html#functions">Functions</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EPECSolve</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Program Listing for File Games.cpp</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/program_listing_file_src_Games.cpp.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="program-listing-for-file-games-cpp">
<span id="program-listing-file-src-games-cpp"></span><h1>Program Listing for File Games.cpp<a class="headerlink" href="#program-listing-for-file-games-cpp" title="Permalink to this headline">¶</a></h1>
<p>↰ <a class="reference internal" href="file_src_Games.cpp.html#file-src-games-cpp"><span class="std std-ref">Return to documentation for file</span></a> (<code class="docutils literal notranslate"><span class="pre">src/Games.cpp</span></code>)</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;games.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;algorithms/algorithms.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;algorithms/combinatorialpne.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;algorithms/fullenumeration.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;algorithms/innerapproximation.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;algorithms/outerapproximation.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;armadillo&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;array&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;boost/log/trivial.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;memory&gt;</span><span class="cp"></span>

<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">Game</span><span class="o">::</span><span class="n">convexHull</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">*&gt;</span>
        <span class="o">*</span><span class="n">Ai</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">*&gt;</span>
        <span class="o">*</span><span class="n">bi</span><span class="p">,</span>
    <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;</span><span class="n">A</span><span class="p">,</span>
    <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span>
        <span class="n">Acom</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">bcom</span>
    <span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// Count number of polyhedra and the space we are in!</span>
  <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nPoly</span><span class="p">{</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">())};</span>
  <span class="c1">// Error check</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">nPoly</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Game::convexHull: Empty std::vector of polyhedra given! Problem &quot;</span>
          <span class="s">&quot;might be &quot;</span>
          <span class="s">&quot;infeasible.&quot;</span><span class="p">);</span> <span class="c1">// There should be at least 1 polyhedron to</span>
  <span class="c1">// consider</span>
  <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nC</span><span class="p">{</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">front</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">n_cols</span><span class="p">)};</span>
  <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nComm</span><span class="p">{</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Acom</span><span class="p">.</span><span class="n">n_rows</span><span class="p">)};</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">nComm</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">Acom</span><span class="p">.</span><span class="n">n_cols</span> <span class="o">!=</span> <span class="n">nC</span><span class="p">)</span>
    <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Game::convexHull: Inconsistent number of variables in the &quot;</span>
          <span class="s">&quot;common polyhedron&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">nComm</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">nComm</span> <span class="o">!=</span> <span class="n">bcom</span><span class="p">.</span><span class="n">n_rows</span><span class="p">)</span>
    <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Game::convexHull: Inconsistent number of rows in LHS and RHS &quot;</span>
          <span class="s">&quot;in the common polyhedron&quot;</span><span class="p">);</span>

  <span class="c1">// Count the number of variables in the convex hull.</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nFinCons</span><span class="p">{</span><span class="mi">0</span><span class="p">},</span> <span class="n">nFinVar</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">nPoly</span> <span class="o">!=</span> <span class="n">bi</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">())</span>
    <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Game::convexHull: Inconsistent number of LHS and RHS for polyhedra&quot;</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">nPoly</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">n_cols</span> <span class="o">!=</span> <span class="n">nC</span><span class="p">)</span>
      <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Game::convexHull: Inconsistent number of variables in the &quot;</span>
            <span class="s">&quot;polyhedra &quot;</span><span class="p">)</span> <span class="o">+</span>
          <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;; &quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">n_cols</span><span class="p">)</span> <span class="o">+</span>
          <span class="s">&quot;!=&quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">nC</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">n_rows</span> <span class="o">!=</span> <span class="n">bi</span><span class="o">-&gt;</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">n_rows</span><span class="p">)</span>
      <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Game::convexHull: Inconsistent number of rows in LHS and &quot;</span>
            <span class="s">&quot;RHS of polyhedra &quot;</span><span class="p">)</span> <span class="o">+</span>
          <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;;&quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">n_rows</span><span class="p">)</span> <span class="o">+</span>
          <span class="s">&quot;!=&quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">bi</span><span class="o">-&gt;</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">n_rows</span><span class="p">);</span>
    <span class="n">nFinCons</span> <span class="o">+=</span> <span class="n">Ai</span><span class="o">-&gt;</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">n_rows</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">// For common constraint copy</span>
  <span class="n">nFinCons</span> <span class="o">+=</span> <span class="n">nPoly</span> <span class="o">*</span> <span class="n">nComm</span><span class="p">;</span>

  <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">FirstCons</span> <span class="o">=</span> <span class="n">nFinCons</span><span class="p">;</span>

  <span class="c1">// 2nd constraint in Eqn 4.31 of Conforti - twice so we have 2 ineq instead of</span>
  <span class="c1">// 1 eq constr</span>
  <span class="n">nFinCons</span> <span class="o">+=</span> <span class="n">nC</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
  <span class="c1">// 3rd constr in Eqn 4.31. Again as two ineq constr.</span>
  <span class="n">nFinCons</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="c1">// Common constraints</span>
  <span class="c1">// nFinCons += Acom.n_rows;</span>

  <span class="n">nFinVar</span> <span class="o">=</span> <span class="n">nPoly</span> <span class="o">*</span> <span class="n">nC</span> <span class="o">+</span> <span class="n">nPoly</span> <span class="o">+</span>
            <span class="n">nC</span><span class="p">;</span> <span class="c1">// All x^i variables + delta variables+ original x variables</span>
  <span class="n">A</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nFinCons</span><span class="p">,</span> <span class="n">nFinVar</span><span class="p">);</span>
  <span class="n">b</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nFinCons</span><span class="p">);</span>
  <span class="c1">// A.zeros(nFinCons, nFinVar); b.zeros(nFinCons);</span>
  <span class="c1">// Implements the first constraint more efficiently using better constructors</span>
  <span class="c1">// for sparse matrix</span>
  <span class="n">Game</span><span class="o">::</span><span class="n">compConvSize</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">nFinCons</span><span class="p">,</span> <span class="n">nFinVar</span><span class="p">,</span> <span class="n">Ai</span><span class="p">,</span> <span class="n">bi</span><span class="p">,</span> <span class="n">Acom</span><span class="p">,</span> <span class="n">bcom</span><span class="p">);</span>

  <span class="c1">// Counting rows completed</span>
  <span class="cm">/****************** SLOW LOOP BEWARE *******************/</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nPoly</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::convexHull: Handling Polyhedron &quot;</span>
                             <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; out of &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">nPoly</span><span class="p">;</span>
    <span class="c1">// First constraint in (4.31)</span>
    <span class="c1">// A.submat(complRow, i*nC, complRow+nConsInPoly-1, (i+1)*nC-1) =</span>
    <span class="c1">// *Ai-&gt;at(i); // Slowest line. Will arma improve this? First constraint RHS</span>
    <span class="c1">// A.submat(complRow, nPoly*nC+i, complRow+nConsInPoly-1, nPoly*nC+i) =</span>
    <span class="c1">// -*bi-&gt;at(i); Second constraint in (4.31)</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">nC</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">A</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">FirstCons</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span> <span class="n">nC</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">nC</span><span class="p">)</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="n">A</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">FirstCons</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nC</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">nC</span><span class="p">)</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// Third constraint in (4.31)</span>
    <span class="n">A</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">FirstCons</span> <span class="o">+</span> <span class="n">nC</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nC</span> <span class="o">+</span> <span class="n">nPoly</span> <span class="o">*</span> <span class="n">nC</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">A</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">FirstCons</span> <span class="o">+</span> <span class="n">nC</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nC</span> <span class="o">+</span> <span class="n">nPoly</span> <span class="o">*</span> <span class="n">nC</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="cm">/****************** SLOW LOOP BEWARE *******************/</span>
  <span class="c1">// Second Constraint RHS</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">nC</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">A</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">FirstCons</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">A</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">FirstCons</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">// Third Constraint RHS</span>
  <span class="n">b</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">FirstCons</span> <span class="o">+</span> <span class="n">nC</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">b</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">FirstCons</span> <span class="o">+</span> <span class="n">nC</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">nPoly</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Game</span><span class="o">::</span><span class="n">compConvSize</span><span class="p">(</span>
    <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;</span><span class="n">A</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nFinCons</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nFinVar</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">*&gt;</span>
        <span class="o">*</span><span class="n">Ai</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">*&gt;</span>
        <span class="o">*</span><span class="n">bi</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span>
        <span class="o">&amp;</span><span class="n">Acom</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">bcom</span>
    <span class="p">)</span>
<span class="p">{</span>
  <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nPoly</span><span class="p">{</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">())};</span>
  <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nC</span><span class="p">{</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Ai</span><span class="o">-&gt;</span><span class="n">front</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">n_cols</span><span class="p">)};</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">N</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span> <span class="c1">// Total number of nonzero elements in the final matrix</span>
  <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">numCommon</span><span class="p">{</span>
      <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Acom</span><span class="p">.</span><span class="n">n_nonzero</span> <span class="o">+</span> <span class="n">bcom</span><span class="p">.</span><span class="n">n_rows</span><span class="p">)};</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nPoly</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">N</span> <span class="o">+=</span> <span class="n">Ai</span><span class="o">-&gt;</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">n_nonzero</span><span class="p">;</span>
    <span class="n">N</span> <span class="o">+=</span> <span class="n">bi</span><span class="o">-&gt;</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">n_rows</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">N</span> <span class="o">+=</span> <span class="n">numCommon</span> <span class="o">*</span>
       <span class="n">nPoly</span><span class="p">;</span> <span class="c1">// The common constraints have to be copied for each polyhedron.</span>

  <span class="c1">// Now computed N which is the total number of nonzeros.</span>
  <span class="n">arma</span><span class="o">::</span><span class="n">umat</span> <span class="n">locations</span><span class="p">;</span> <span class="c1">// location of nonzeros</span>
  <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">val</span><span class="p">;</span>        <span class="c1">// nonzero values</span>
  <span class="n">locations</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">);</span>
  <span class="n">val</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>

  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">count</span><span class="p">{</span><span class="mi">0</span><span class="p">},</span> <span class="n">rowCount</span><span class="p">{</span><span class="mi">0</span><span class="p">},</span> <span class="n">colCount</span><span class="p">{</span><span class="n">nC</span><span class="p">};</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nPoly</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">it</span> <span class="o">=</span> <span class="n">Ai</span><span class="o">-&gt;</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">begin</span><span class="p">();</span> <span class="n">it</span> <span class="o">!=</span> <span class="n">Ai</span><span class="o">-&gt;</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">end</span><span class="p">();</span>
         <span class="o">++</span><span class="n">it</span><span class="p">)</span> <span class="c1">// First constraint</span>
    <span class="p">{</span>
      <span class="n">locations</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="o">=</span> <span class="n">rowCount</span> <span class="o">+</span> <span class="n">it</span><span class="p">.</span><span class="n">row</span><span class="p">();</span>
      <span class="n">locations</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="o">=</span> <span class="n">colCount</span> <span class="o">+</span> <span class="n">it</span><span class="p">.</span><span class="n">col</span><span class="p">();</span>
      <span class="n">val</span><span class="p">(</span><span class="n">count</span><span class="p">)</span> <span class="o">=</span> <span class="o">*</span><span class="n">it</span><span class="p">;</span>
      <span class="o">++</span><span class="n">count</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">bi</span><span class="o">-&gt;</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">n_rows</span><span class="p">;</span>
         <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="c1">// RHS of first constraint</span>
    <span class="p">{</span>
      <span class="n">locations</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="o">=</span> <span class="n">rowCount</span> <span class="o">+</span> <span class="n">j</span><span class="p">;</span>
      <span class="n">locations</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="o">=</span> <span class="n">nC</span> <span class="o">+</span> <span class="n">nC</span> <span class="o">*</span> <span class="n">nPoly</span> <span class="o">+</span> <span class="n">i</span><span class="p">;</span>
      <span class="n">val</span><span class="p">(</span><span class="n">count</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">bi</span><span class="o">-&gt;</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">at</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
      <span class="o">++</span><span class="n">count</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">rowCount</span> <span class="o">+=</span> <span class="n">Ai</span><span class="o">-&gt;</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">n_rows</span><span class="p">;</span>

    <span class="c1">// For common constraints</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">it</span> <span class="o">=</span> <span class="n">Acom</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">it</span> <span class="o">!=</span> <span class="n">Acom</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="o">++</span><span class="n">it</span><span class="p">)</span> <span class="c1">// First constraint</span>
    <span class="p">{</span>
      <span class="n">locations</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="o">=</span> <span class="n">rowCount</span> <span class="o">+</span> <span class="n">it</span><span class="p">.</span><span class="n">row</span><span class="p">();</span>
      <span class="n">locations</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="o">=</span> <span class="n">colCount</span> <span class="o">+</span> <span class="n">it</span><span class="p">.</span><span class="n">col</span><span class="p">();</span>
      <span class="n">val</span><span class="p">(</span><span class="n">count</span><span class="p">)</span> <span class="o">=</span> <span class="o">*</span><span class="n">it</span><span class="p">;</span>
      <span class="o">++</span><span class="n">count</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">bcom</span><span class="p">.</span><span class="n">n_rows</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="c1">// RHS of first constraint</span>
    <span class="p">{</span>
      <span class="n">locations</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="o">=</span> <span class="n">rowCount</span> <span class="o">+</span> <span class="n">j</span><span class="p">;</span>
      <span class="n">locations</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="o">=</span> <span class="n">nC</span> <span class="o">+</span> <span class="n">nC</span> <span class="o">*</span> <span class="n">nPoly</span> <span class="o">+</span> <span class="n">i</span><span class="p">;</span>
      <span class="n">val</span><span class="p">(</span><span class="n">count</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">bcom</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
      <span class="o">++</span><span class="n">count</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">rowCount</span> <span class="o">+=</span> <span class="n">Acom</span><span class="p">.</span><span class="n">n_rows</span><span class="p">;</span>

    <span class="n">colCount</span> <span class="o">+=</span> <span class="n">nC</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">A</span> <span class="o">=</span> <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span><span class="p">(</span><span class="n">locations</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">nFinCons</span><span class="p">,</span> <span class="n">nFinVar</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">arma</span><span class="o">::</span><span class="n">vec</span>
<span class="n">Game</span><span class="o">::</span><span class="n">LPSolve</span><span class="p">(</span><span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;</span><span class="n">A</span><span class="p">,</span>
              <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">,</span>
              <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">c</span><span class="p">,</span>
              <span class="kt">int</span> <span class="o">&amp;</span><span class="n">status</span><span class="p">,</span>
              <span class="kt">bool</span> <span class="n">positivity</span>
              <span class="p">)</span>
<span class="p">{</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nR</span><span class="p">,</span> <span class="n">nC</span><span class="p">;</span>
  <span class="n">nR</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">n_rows</span><span class="p">;</span>
  <span class="n">nC</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">n_cols</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">n_rows</span> <span class="o">!=</span> <span class="n">nC</span><span class="p">)</span>
    <span class="k">throw</span> <span class="s">&quot;Game::LPSolve: Inconsistency in no of Vars in isFeas()&quot;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">n_rows</span> <span class="o">!=</span> <span class="n">nR</span><span class="p">)</span>
    <span class="k">throw</span> <span class="s">&quot;Game::LPSolve: Inconsistency in no of Constr in isFeas()&quot;</span><span class="p">;</span>

  <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">fill</span><span class="o">::</span><span class="n">zeros</span><span class="p">);</span>
  <span class="k">const</span> <span class="kt">double</span> <span class="n">lb</span> <span class="o">=</span> <span class="n">positivity</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="o">-</span><span class="n">GRB_INFINITY</span><span class="p">;</span>

  <span class="n">GRBEnv</span> <span class="n">env</span><span class="p">;</span>
  <span class="n">GRBModel</span> <span class="n">model</span> <span class="o">=</span> <span class="n">GRBModel</span><span class="p">(</span><span class="n">env</span><span class="p">);</span>
  <span class="n">GRBVar</span> <span class="n">x</span><span class="p">[</span><span class="n">nC</span><span class="p">];</span>
  <span class="n">GRBConstr</span> <span class="n">a</span><span class="p">[</span><span class="n">nR</span><span class="p">];</span>
  <span class="c1">// Adding Variables</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nC</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">addVar</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">GRB_INFINITY</span><span class="p">,</span> <span class="n">c</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">GRB_CONTINUOUS</span><span class="p">,</span>
                        <span class="s">&quot;x_&quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
  <span class="c1">// Adding constraints</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nR</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">GRBLinExpr</span> <span class="n">lin</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">j</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">begin_row</span><span class="p">(</span><span class="n">i</span><span class="p">);</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">A</span><span class="p">.</span><span class="n">end_row</span><span class="p">(</span><span class="n">i</span><span class="p">);</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
      <span class="n">lin</span> <span class="o">+=</span> <span class="p">(</span><span class="o">*</span><span class="n">j</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">.</span><span class="n">col</span><span class="p">()];</span>
    <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">addConstr</span><span class="p">(</span><span class="n">lin</span><span class="p">,</span> <span class="n">GRB_LESS_EQUAL</span><span class="p">,</span> <span class="n">b</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="n">model</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">GRB_IntParam_OutputFlag</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="n">model</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">GRB_IntParam_DualReductions</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="n">model</span><span class="p">.</span><span class="n">optimize</span><span class="p">();</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">GRB_IntAttr_Status</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">==</span> <span class="n">GRB_OPTIMAL</span><span class="p">)</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nC</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
      <span class="n">sol</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">get</span><span class="p">(</span><span class="n">GRB_DoubleAttr_X</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">sol</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">Game</span><span class="o">::</span><span class="n">isZero</span><span class="p">(</span><span class="n">arma</span><span class="o">::</span><span class="n">mat</span> <span class="n">M</span><span class="p">,</span> <span class="kt">double</span> <span class="n">tol</span><span class="p">)</span> <span class="k">noexcept</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">arma</span><span class="o">::</span><span class="n">min</span><span class="p">(</span><span class="n">arma</span><span class="o">::</span><span class="n">min</span><span class="p">(</span><span class="n">abs</span><span class="p">(</span><span class="n">M</span><span class="p">)))</span> <span class="o">&lt;=</span> <span class="n">tol</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">Game</span><span class="o">::</span><span class="n">isZero</span><span class="p">(</span><span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="n">M</span><span class="p">,</span> <span class="kt">double</span> <span class="n">tol</span><span class="p">)</span> <span class="k">noexcept</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">M</span><span class="p">.</span><span class="n">n_nonzero</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">arma</span><span class="o">::</span><span class="n">min</span><span class="p">(</span><span class="n">arma</span><span class="o">::</span><span class="n">min</span><span class="p">(</span><span class="n">abs</span><span class="p">(</span><span class="n">M</span><span class="p">)))</span> <span class="o">&lt;=</span> <span class="n">tol</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Game</span><span class="o">::</span><span class="n">print</span><span class="p">(</span><span class="k">const</span> <span class="n">perps</span> <span class="o">&amp;</span><span class="n">C</span><span class="p">)</span> <span class="k">noexcept</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">p</span> <span class="p">:</span> <span class="n">C</span><span class="p">)</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;&lt;&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;&gt;&quot;</span>
              <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">ostream</span> <span class="o">&amp;</span><span class="k">operator</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">ostream</span> <span class="o">&amp;</span><span class="n">ost</span><span class="p">,</span> <span class="k">const</span> <span class="n">perps</span> <span class="o">&amp;</span><span class="n">C</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">p</span> <span class="p">:</span> <span class="n">C</span><span class="p">)</span>
    <span class="n">ost</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;&lt;&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;&gt;&quot;</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">ost</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">ostream</span> <span class="o">&amp;</span><span class="n">Game</span><span class="o">::</span><span class="k">operator</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">ostream</span> <span class="o">&amp;</span><span class="n">os</span><span class="p">,</span> <span class="k">const</span> <span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span> <span class="o">&amp;</span><span class="n">Q</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">os</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Quadratic program with linear inequality constraints: &quot;</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
  <span class="n">os</span> <span class="o">&lt;&lt;</span> <span class="n">Q</span><span class="p">.</span><span class="n">getNy</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; decision variables parametrized by &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Q</span><span class="p">.</span><span class="n">getNx</span><span class="p">()</span>
     <span class="o">&lt;&lt;</span> <span class="s">&quot; variables&quot;</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
  <span class="n">os</span> <span class="o">&lt;&lt;</span> <span class="n">Q</span><span class="p">.</span><span class="n">getb</span><span class="p">().</span><span class="n">n_rows</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; linear inequalities&quot;</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">os</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Game</span><span class="o">::</span><span class="n">MP_Param</span><span class="o">::</span><span class="n">write</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">filename</span><span class="p">,</span> <span class="kt">bool</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">getQ</span><span class="p">().</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s">&quot;_Q.txt&quot;</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">file_type</span><span class="o">::</span><span class="n">arma_ascii</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">getC</span><span class="p">().</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s">&quot;_C.txt&quot;</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">file_type</span><span class="o">::</span><span class="n">arma_ascii</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">getA</span><span class="p">().</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s">&quot;_A.txt&quot;</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">file_type</span><span class="o">::</span><span class="n">arma_ascii</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">getB</span><span class="p">().</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s">&quot;_B.txt&quot;</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">file_type</span><span class="o">::</span><span class="n">arma_ascii</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">getc</span><span class="p">().</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s">&quot;_c.txt&quot;</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">file_type</span><span class="o">::</span><span class="n">arma_ascii</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">getb</span><span class="p">().</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s">&quot;_b.txt&quot;</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">file_type</span><span class="o">::</span><span class="n">arma_ascii</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span><span class="o">::</span><span class="n">write</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">filename</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">append</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">ofstream</span> <span class="n">file</span><span class="p">;</span>
  <span class="n">file</span><span class="p">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">append</span> <span class="o">?</span> <span class="n">arma</span><span class="o">::</span><span class="n">ios</span><span class="o">::</span><span class="nl">app</span> <span class="p">:</span> <span class="n">arma</span><span class="o">::</span><span class="n">ios</span><span class="o">::</span><span class="n">out</span><span class="p">);</span>
  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n\n</span><span class="s">OBJECTIVES</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Q:&quot;</span> <span class="o">&lt;&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">getQ</span><span class="p">();</span>
  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;C:&quot;</span> <span class="o">&lt;&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">getC</span><span class="p">();</span>
  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;c</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">&lt;&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">getc</span><span class="p">();</span>
  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n\n</span><span class="s">CONSTRAINTS</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;A:&quot;</span> <span class="o">&lt;&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">getA</span><span class="p">();</span>
  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;B:&quot;</span> <span class="o">&lt;&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">getB</span><span class="p">();</span>
  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;b</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">&lt;&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">getb</span><span class="p">();</span>
  <span class="n">file</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">Game</span><span class="o">::</span><span class="n">MP_Param</span> <span class="o">&amp;</span><span class="n">Game</span><span class="o">::</span><span class="n">MP_Param</span><span class="o">::</span><span class="n">addDummy</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">pars</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">vars</span><span class="p">,</span>
                                         <span class="kt">int</span> <span class="n">position</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">Nx</span> <span class="o">+=</span> <span class="n">pars</span><span class="p">;</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">Ny</span> <span class="o">+=</span> <span class="n">vars</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">vars</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">resizePatch</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Ny</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Ny</span><span class="p">);</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">resizePatch</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Ncons</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Ny</span><span class="p">);</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">resizePatch</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Ny</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">switch</span> <span class="p">(</span><span class="n">position</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">case</span> <span class="o">-</span><span class="mi">1</span><span class="o">:</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pars</span><span class="p">)</span>
      <span class="n">A</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">resizePatch</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Ncons</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Nx</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">vars</span> <span class="o">||</span> <span class="n">pars</span><span class="p">)</span>
      <span class="n">C</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">resizePatch</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Ny</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Nx</span><span class="p">);</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pars</span><span class="p">)</span>
      <span class="n">A</span> <span class="o">=</span> <span class="n">arma</span><span class="o">::</span><span class="n">join_rows</span><span class="p">(</span><span class="n">arma</span><span class="o">::</span><span class="n">zeros</span><span class="o">&lt;</span><span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span><span class="o">&gt;</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Ncons</span><span class="p">,</span> <span class="n">pars</span><span class="p">),</span> <span class="n">A</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">vars</span> <span class="o">||</span> <span class="n">pars</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">C</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">resizePatch</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Ny</span><span class="p">,</span> <span class="n">C</span><span class="p">.</span><span class="n">n_cols</span><span class="p">);</span>
      <span class="n">C</span> <span class="o">=</span> <span class="n">arma</span><span class="o">::</span><span class="n">join_rows</span><span class="p">(</span><span class="n">arma</span><span class="o">::</span><span class="n">zeros</span><span class="o">&lt;</span><span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span><span class="o">&gt;</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Ny</span><span class="p">,</span> <span class="n">pars</span><span class="p">),</span> <span class="n">C</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="k">default</span><span class="o">:</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pars</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="n">A_temp</span> <span class="o">=</span>
          <span class="n">arma</span><span class="o">::</span><span class="n">join_rows</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">cols</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">position</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
                          <span class="n">arma</span><span class="o">::</span><span class="n">zeros</span><span class="o">&lt;</span><span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span><span class="o">&gt;</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Ncons</span><span class="p">,</span> <span class="n">pars</span><span class="p">));</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">position</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">A</span><span class="p">.</span><span class="n">n_cols</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">arma</span><span class="o">::</span><span class="n">join_rows</span><span class="p">(</span><span class="n">A_temp</span><span class="p">,</span> <span class="n">A</span><span class="p">.</span><span class="n">cols</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">A</span><span class="p">.</span><span class="n">n_cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">));</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">A_temp</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">vars</span> <span class="o">||</span> <span class="n">pars</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">C</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">resizePatch</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Ny</span><span class="p">,</span> <span class="n">C</span><span class="p">.</span><span class="n">n_cols</span><span class="p">);</span>
      <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="n">C_temp</span> <span class="o">=</span> <span class="n">arma</span><span class="o">::</span><span class="n">join_rows</span><span class="p">(</span>
          <span class="n">C</span><span class="p">.</span><span class="n">cols</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">position</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">arma</span><span class="o">::</span><span class="n">zeros</span><span class="o">&lt;</span><span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span><span class="o">&gt;</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Ny</span><span class="p">,</span> <span class="n">pars</span><span class="p">));</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">position</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">C</span><span class="p">.</span><span class="n">n_cols</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">arma</span><span class="o">::</span><span class="n">join_rows</span><span class="p">(</span><span class="n">C_temp</span><span class="p">,</span> <span class="n">C</span><span class="p">.</span><span class="n">cols</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">C</span><span class="p">.</span><span class="n">n_cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">));</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">C_temp</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="p">};</span>
  <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">Game</span><span class="o">::</span><span class="n">MP_Param</span><span class="o">::</span><span class="n">size</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">Ny</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Q</span><span class="p">.</span><span class="n">n_rows</span><span class="p">;</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">Nx</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">C</span><span class="p">.</span><span class="n">n_cols</span><span class="p">;</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">Ncons</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
  <span class="k">return</span> <span class="n">Ny</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Game</span><span class="o">::</span><span class="n">MP_Param</span> <span class="o">&amp;</span>
<span class="n">Game</span><span class="o">::</span><span class="n">MP_Param</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;</span><span class="n">Q</span><span class="p">,</span> <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;</span><span class="n">C</span><span class="p">,</span>
                    <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;</span><span class="n">A</span><span class="p">,</span> <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;</span><span class="n">B</span><span class="p">,</span>
                    <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">c</span><span class="p">,</span> <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">Q</span> <span class="o">=</span> <span class="p">(</span><span class="n">Q</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="n">C</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">B</span> <span class="o">=</span> <span class="p">(</span><span class="n">B</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">finalize</span><span class="p">())</span>
    <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Error in MP_Param::set: Invalid data&quot;</span><span class="p">);</span>
  <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Game</span><span class="o">::</span><span class="n">MP_Param</span> <span class="o">&amp;</span><span class="n">Game</span><span class="o">::</span><span class="n">MP_Param</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;&amp;</span><span class="n">Q</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;&amp;</span><span class="n">C</span><span class="p">,</span>
                                    <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;&amp;</span><span class="n">A</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;&amp;</span><span class="n">B</span><span class="p">,</span>
                                    <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;&amp;</span><span class="n">c</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;&amp;</span><span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">Q</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">Q</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">C</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">C</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">A</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">B</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">B</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">c</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">b</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">finalize</span><span class="p">())</span>
    <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Error in MP_Param::set: Invalid data&quot;</span><span class="p">);</span>
  <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Game</span><span class="o">::</span><span class="n">MP_Param</span> <span class="o">&amp;</span><span class="n">Game</span><span class="o">::</span><span class="n">MP_Param</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="k">const</span> <span class="n">QP_Objective</span> <span class="o">&amp;</span><span class="n">obj</span><span class="p">,</span>
                                    <span class="k">const</span> <span class="n">QP_Constraints</span> <span class="o">&amp;</span><span class="n">cons</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">set</span><span class="p">(</span><span class="n">obj</span><span class="p">.</span><span class="n">Q</span><span class="p">,</span> <span class="n">obj</span><span class="p">.</span><span class="n">C</span><span class="p">,</span> <span class="n">cons</span><span class="p">.</span><span class="n">A</span><span class="p">,</span> <span class="n">cons</span><span class="p">.</span><span class="n">B</span><span class="p">,</span> <span class="n">obj</span><span class="p">.</span><span class="n">c</span><span class="p">,</span> <span class="n">cons</span><span class="p">.</span><span class="n">b</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">Game</span><span class="o">::</span><span class="n">MP_Param</span> <span class="o">&amp;</span><span class="n">Game</span><span class="o">::</span><span class="n">MP_Param</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="n">QP_Objective</span> <span class="o">&amp;&amp;</span><span class="n">obj</span><span class="p">,</span> <span class="n">QP_Constraints</span> <span class="o">&amp;&amp;</span><span class="n">cons</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">set</span><span class="p">(</span><span class="n">obj</span><span class="p">.</span><span class="n">Q</span><span class="p">,</span> <span class="n">obj</span><span class="p">.</span><span class="n">C</span><span class="p">,</span> <span class="n">cons</span><span class="p">.</span><span class="n">A</span><span class="p">,</span> <span class="n">cons</span><span class="p">.</span><span class="n">B</span><span class="p">,</span> <span class="n">obj</span><span class="p">.</span><span class="n">c</span><span class="p">,</span> <span class="n">cons</span><span class="p">.</span><span class="n">b</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">Game</span><span class="o">::</span><span class="n">MP_Param</span><span class="o">::</span><span class="n">dataCheck</span><span class="p">(</span><span class="kt">bool</span> <span class="n">forceSymmetry</span><span class="p">)</span> <span class="k">const</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">forceSymmetry</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Q</span><span class="p">.</span><span class="n">n_cols</span> <span class="o">!=</span> <span class="n">Ny</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">A</span><span class="p">.</span><span class="n">n_cols</span> <span class="o">!=</span> <span class="n">Nx</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="p">}</span> <span class="c1">// Rest are matrix size compatibility checks</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">B</span><span class="p">.</span><span class="n">n_cols</span> <span class="o">!=</span> <span class="n">Ny</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">C</span><span class="p">.</span><span class="n">n_rows</span> <span class="o">!=</span> <span class="n">Ny</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">c</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">!=</span> <span class="n">Ny</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">A</span><span class="p">.</span><span class="n">n_rows</span> <span class="o">!=</span> <span class="n">Ncons</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">B</span><span class="p">.</span><span class="n">n_rows</span> <span class="o">!=</span> <span class="n">Ncons</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">Game</span><span class="o">::</span><span class="n">MP_Param</span><span class="o">::</span><span class="n">dataCheck</span><span class="p">(</span><span class="k">const</span> <span class="n">QP_Objective</span> <span class="o">&amp;</span><span class="n">obj</span><span class="p">,</span>
                               <span class="k">const</span> <span class="n">QP_Constraints</span> <span class="o">&amp;</span><span class="n">cons</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">checkobj</span><span class="p">,</span>
                               <span class="kt">bool</span> <span class="n">checkcons</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">Ny</span> <span class="o">=</span> <span class="n">obj</span><span class="p">.</span><span class="n">Q</span><span class="p">.</span><span class="n">n_rows</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">Nx</span> <span class="o">=</span> <span class="n">obj</span><span class="p">.</span><span class="n">C</span><span class="p">.</span><span class="n">n_cols</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">Ncons</span> <span class="o">=</span> <span class="n">cons</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">checkobj</span> <span class="o">&amp;&amp;</span> <span class="n">obj</span><span class="p">.</span><span class="n">Q</span><span class="p">.</span><span class="n">n_cols</span> <span class="o">!=</span> <span class="n">Ny</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">checkobj</span> <span class="o">&amp;&amp;</span> <span class="n">obj</span><span class="p">.</span><span class="n">C</span><span class="p">.</span><span class="n">n_rows</span> <span class="o">!=</span> <span class="n">Ny</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">checkobj</span> <span class="o">&amp;&amp;</span> <span class="n">obj</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">!=</span> <span class="n">Ny</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">checkcons</span> <span class="o">&amp;&amp;</span> <span class="n">cons</span><span class="p">.</span><span class="n">A</span><span class="p">.</span><span class="n">n_cols</span> <span class="o">!=</span> <span class="n">Nx</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="p">}</span> <span class="c1">// Rest are matrix size compatibility checks</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">checkcons</span> <span class="o">&amp;&amp;</span> <span class="n">cons</span><span class="p">.</span><span class="n">B</span><span class="p">.</span><span class="n">n_cols</span> <span class="o">!=</span> <span class="n">Ny</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">checkcons</span> <span class="o">&amp;&amp;</span> <span class="n">cons</span><span class="p">.</span><span class="n">A</span><span class="p">.</span><span class="n">n_rows</span> <span class="o">!=</span> <span class="n">Ncons</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">checkcons</span> <span class="o">&amp;&amp;</span> <span class="n">cons</span><span class="p">.</span><span class="n">B</span><span class="p">.</span><span class="n">n_rows</span> <span class="o">!=</span> <span class="n">Ncons</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span><span class="o">::</span><span class="k">operator</span><span class="o">==</span><span class="p">(</span><span class="k">const</span> <span class="n">QP_Param</span> <span class="o">&amp;</span><span class="n">Q2</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Game</span><span class="o">::</span><span class="n">isZero</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Q</span> <span class="o">-</span> <span class="n">Q2</span><span class="p">.</span><span class="n">getQ</span><span class="p">()))</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Game</span><span class="o">::</span><span class="n">isZero</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">C</span> <span class="o">-</span> <span class="n">Q2</span><span class="p">.</span><span class="n">getC</span><span class="p">()))</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Game</span><span class="o">::</span><span class="n">isZero</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">A</span> <span class="o">-</span> <span class="n">Q2</span><span class="p">.</span><span class="n">getA</span><span class="p">()))</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Game</span><span class="o">::</span><span class="n">isZero</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">B</span> <span class="o">-</span> <span class="n">Q2</span><span class="p">.</span><span class="n">getB</span><span class="p">()))</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Game</span><span class="o">::</span><span class="n">isZero</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">c</span> <span class="o">-</span> <span class="n">Q2</span><span class="p">.</span><span class="n">getc</span><span class="p">()))</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Game</span><span class="o">::</span><span class="n">isZero</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">b</span> <span class="o">-</span> <span class="n">Q2</span><span class="p">.</span><span class="n">getb</span><span class="p">()))</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span><span class="o">::</span><span class="n">makeyQy</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">madeyQy</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">GRBVar</span> <span class="n">y</span><span class="p">[</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Ny</span><span class="p">];</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">Ny</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">QuadModel</span><span class="p">.</span><span class="n">addVar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">GRB_INFINITY</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">GRB_CONTINUOUS</span><span class="p">,</span>
                                  <span class="s">&quot;y_&quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
  <span class="n">GRBQuadExpr</span> <span class="n">yQy</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
  <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">val</span> <span class="o">=</span> <span class="n">Q</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">val</span> <span class="o">!=</span> <span class="n">Q</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="o">++</span><span class="n">val</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
    <span class="kt">double</span> <span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">val</span><span class="p">);</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">val</span><span class="p">.</span><span class="n">row</span><span class="p">();</span>
    <span class="n">j</span> <span class="o">=</span> <span class="n">val</span><span class="p">.</span><span class="n">col</span><span class="p">();</span>
    <span class="n">yQy</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">value</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
  <span class="p">}</span>
  <span class="n">QuadModel</span><span class="p">.</span><span class="n">setObjective</span><span class="p">(</span><span class="n">yQy</span><span class="p">,</span> <span class="n">GRB_MINIMIZE</span><span class="p">);</span>
  <span class="n">QuadModel</span><span class="p">.</span><span class="n">update</span><span class="p">();</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">madeyQy</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">GRBModel</span><span class="o">&gt;</span> <span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span><span class="o">::</span><span class="n">solveFixed</span><span class="p">(</span>
    <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">x</span><span class="p">,</span>
    <span class="kt">bool</span> <span class="n">solve</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">makeyQy</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">!=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Nx</span><span class="p">)</span>
    <span class="k">throw</span> <span class="s">&quot;Game::QP_Param::solveFixed: Invalid argument size: &quot;</span> <span class="o">+</span>
        <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="o">+</span> <span class="s">&quot; != &quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">Nx</span><span class="p">);</span>
  <span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">GRBModel</span><span class="o">&gt;</span> <span class="n">model</span><span class="p">(</span><span class="k">new</span> <span class="n">GRBModel</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">QuadModel</span><span class="p">));</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">GRBQuadExpr</span> <span class="n">yQy</span> <span class="o">=</span> <span class="n">model</span><span class="o">-&gt;</span><span class="n">getObjective</span><span class="p">();</span>
    <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">Cx</span><span class="p">,</span> <span class="n">Ax</span><span class="p">;</span>
    <span class="n">Cx</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">C</span> <span class="o">*</span> <span class="n">x</span><span class="p">;</span>
    <span class="n">Ax</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">A</span> <span class="o">*</span> <span class="n">x</span><span class="p">;</span>
    <span class="n">GRBVar</span> <span class="n">y</span><span class="p">[</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Ny</span><span class="p">];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Ny</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">-&gt;</span><span class="n">getVarByName</span><span class="p">(</span><span class="s">&quot;y_&quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
      <span class="n">yQy</span> <span class="o">+=</span> <span class="p">(</span><span class="n">Cx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">model</span><span class="o">-&gt;</span><span class="n">setObjective</span><span class="p">(</span><span class="n">yQy</span><span class="p">,</span> <span class="n">GRB_MINIMIZE</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Ncons</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">GRBLinExpr</span> <span class="n">LHS</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
      <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">j</span> <span class="o">=</span> <span class="n">B</span><span class="p">.</span><span class="n">begin_row</span><span class="p">(</span><span class="n">i</span><span class="p">);</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">B</span><span class="p">.</span><span class="n">end_row</span><span class="p">(</span><span class="n">i</span><span class="p">);</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
        <span class="n">LHS</span> <span class="o">+=</span> <span class="p">(</span><span class="o">*</span><span class="n">j</span><span class="p">)</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">.</span><span class="n">col</span><span class="p">()];</span>
      <span class="n">model</span><span class="o">-&gt;</span><span class="n">addConstr</span><span class="p">(</span><span class="n">LHS</span><span class="p">,</span> <span class="n">GRB_LESS_EQUAL</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">Ax</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="n">model</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">();</span>
    <span class="n">model</span><span class="o">-&gt;</span><span class="n">set</span><span class="p">(</span><span class="n">GRB_IntParam_OutputFlag</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">solve</span><span class="p">)</span>
      <span class="n">model</span><span class="o">-&gt;</span><span class="n">optimize</span><span class="p">();</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; Error in Game::QP_Param::solveFixed: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;String: Error in Game::QP_Param::solveFixed: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">exception</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Exception: Error in Game::QP_Param::solveFixed: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">()</span>
              <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">GRBException</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;GRBException: Error in Game::QP_Param::solveFixed: &quot;</span>
              <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="n">getErrorCode</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;; &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="n">getMessage</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">model</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span> <span class="o">&amp;</span><span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span><span class="o">::</span><span class="n">addDummy</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">pars</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">vars</span><span class="p">,</span>
                                         <span class="kt">int</span> <span class="n">position</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// if ((pars || vars))</span>
  <span class="c1">// BOOST_LOG_TRIVIAL(trace)</span>
  <span class="c1">// &lt;&lt; &quot;From Game::QP_Param::addDummyVars:\t You might have to rerun</span>
  <span class="c1">// Games::QP_Param::KKT since you have now changed the number of variables in</span>
  <span class="c1">// the NashGame.&quot;;</span>

  <span class="c1">// Call the superclass function</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">MP_Param</span><span class="o">::</span><span class="n">addDummy</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">vars</span><span class="p">,</span> <span class="n">position</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; Error in Game::QP_Param::addDummy: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;String: Error in Game::QP_Param::addDummy: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">exception</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Exception: Error in Game::QP_Param::addDummy: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">()</span>
              <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span><span class="o">::</span><span class="n">KKT</span><span class="p">(</span><span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;</span><span class="n">M</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;</span><span class="n">N</span><span class="p">,</span>
                                 <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">q</span><span class="p">)</span> <span class="k">const</span>

<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">dataCheck</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Inconsistent data for KKT of Game::QP_Param::KKT&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">M</span> <span class="o">=</span> <span class="n">arma</span><span class="o">::</span><span class="n">join_cols</span><span class="p">(</span> <span class="c1">// In armadillo join_cols(A, B) is same as [A;B] in</span>
                       <span class="c1">// Matlab</span>
                       <span class="c1">//  join_rows(A, B) is same as [A B] in Matlab</span>
      <span class="n">arma</span><span class="o">::</span><span class="n">join_rows</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Q</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">B</span><span class="p">.</span><span class="n">t</span><span class="p">()),</span>
      <span class="n">arma</span><span class="o">::</span><span class="n">join_rows</span><span class="p">(</span><span class="o">-</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">B</span><span class="p">,</span>
                      <span class="n">arma</span><span class="o">::</span><span class="n">zeros</span><span class="o">&lt;</span><span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span><span class="o">&gt;</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Ncons</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Ncons</span><span class="p">)));</span>
  <span class="c1">// M.print_dense();</span>
  <span class="n">N</span> <span class="o">=</span> <span class="n">arma</span><span class="o">::</span><span class="n">join_cols</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">C</span><span class="p">,</span> <span class="o">-</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">A</span><span class="p">);</span>
  <span class="c1">// N.print_dense();</span>
  <span class="n">q</span> <span class="o">=</span> <span class="n">arma</span><span class="o">::</span><span class="n">join_cols</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">c</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">b</span><span class="p">);</span>
  <span class="c1">// q.print();</span>
  <span class="k">return</span> <span class="n">M</span><span class="p">.</span><span class="n">n_rows</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span> <span class="o">&amp;</span>
<span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;</span><span class="n">Q</span><span class="p">,</span> <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;</span><span class="n">C</span><span class="p">,</span>
                    <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;</span><span class="n">A</span><span class="p">,</span> <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;</span><span class="n">B</span><span class="p">,</span>
                    <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">c</span><span class="p">,</span> <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">madeyQy</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">MP_Param</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;String: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Error in QP_Param::set: Invalid Data&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span> <span class="o">&amp;</span><span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;&amp;</span><span class="n">Q</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;&amp;</span><span class="n">C</span><span class="p">,</span>
                                    <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;&amp;</span><span class="n">A</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;&amp;</span><span class="n">B</span><span class="p">,</span>
                                    <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;&amp;</span><span class="n">c</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;&amp;</span><span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">madeyQy</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">MP_Param</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;String: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Error in QP_Param::set: Invalid Data&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span> <span class="o">&amp;</span><span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="n">QP_Objective</span> <span class="o">&amp;&amp;</span><span class="n">obj</span><span class="p">,</span> <span class="n">QP_Constraints</span> <span class="o">&amp;&amp;</span><span class="n">cons</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">set</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">obj</span><span class="p">.</span><span class="n">Q</span><span class="p">),</span> <span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">obj</span><span class="p">.</span><span class="n">C</span><span class="p">),</span> <span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">cons</span><span class="p">.</span><span class="n">A</span><span class="p">),</span>
                   <span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">cons</span><span class="p">.</span><span class="n">B</span><span class="p">),</span> <span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">obj</span><span class="p">.</span><span class="n">c</span><span class="p">),</span> <span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">cons</span><span class="p">.</span><span class="n">b</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span> <span class="o">&amp;</span><span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="k">const</span> <span class="n">QP_Objective</span> <span class="o">&amp;</span><span class="n">obj</span><span class="p">,</span>
                                    <span class="k">const</span> <span class="n">QP_Constraints</span> <span class="o">&amp;</span><span class="n">cons</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">set</span><span class="p">(</span><span class="n">obj</span><span class="p">.</span><span class="n">Q</span><span class="p">,</span> <span class="n">obj</span><span class="p">.</span><span class="n">C</span><span class="p">,</span> <span class="n">cons</span><span class="p">.</span><span class="n">A</span><span class="p">,</span> <span class="n">cons</span><span class="p">.</span><span class="n">B</span><span class="p">,</span> <span class="n">obj</span><span class="p">.</span><span class="n">c</span><span class="p">,</span> <span class="n">cons</span><span class="p">.</span><span class="n">b</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span><span class="o">::</span><span class="n">getConstraintViolations</span><span class="p">(</span><span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">x</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">y</span><span class="p">,</span>
                                                  <span class="kt">double</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">B</span><span class="p">.</span><span class="n">n_cols</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">resizePatch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">B</span><span class="p">.</span><span class="n">n_cols</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">A</span><span class="p">.</span><span class="n">n_cols</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">resizePatch</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">A</span><span class="p">.</span><span class="n">n_cols</span><span class="p">);</span>
  <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">slack</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">B</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span> <span class="n">b</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">slack</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">double</span> <span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span><span class="o">::</span><span class="n">computeObjective</span><span class="p">(</span><span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">,</span> <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span>
                                        <span class="kt">bool</span> <span class="n">checkFeas</span><span class="p">,</span> <span class="kt">double</span> <span class="n">tol</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">n_rows</span> <span class="o">!=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">getNy</span><span class="p">())</span>
    <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Error in QP_Param::computeObjective: Invalid size of y&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">n_rows</span> <span class="o">!=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">getNx</span><span class="p">())</span>
    <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Error in QP_Param::computeObjective: Invalid size of x&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">checkFeas</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">slack</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">B</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span> <span class="n">b</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">slack</span><span class="p">.</span><span class="n">n_rows</span><span class="p">)</span> <span class="c1">// if infeasible</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">slack</span><span class="p">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">tol</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">GRB_INFINITY</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">tol</span><span class="p">)</span> <span class="c1">// if infeasible</span>
      <span class="k">return</span> <span class="n">GRB_INFINITY</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">obj</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">y</span><span class="p">.</span><span class="n">t</span><span class="p">()</span> <span class="o">*</span> <span class="n">Q</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">C</span> <span class="o">*</span> <span class="n">x</span><span class="p">).</span><span class="n">t</span><span class="p">()</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">c</span><span class="p">.</span><span class="n">t</span><span class="p">()</span> <span class="o">*</span> <span class="n">y</span><span class="p">;</span>
  <span class="k">return</span> <span class="nf">obj</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">double</span> <span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span><span class="o">::</span><span class="n">computeObjectiveWithoutOthers</span><span class="p">(</span><span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">n_rows</span> <span class="o">!=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">getNy</span><span class="p">())</span>
    <span class="k">throw</span><span class="p">(</span>
        <span class="s">&quot;Error in QP_Param::computeObjectiveWithoutOthers: Invalid size of y&quot;</span><span class="p">);</span>
  <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">obj</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">y</span><span class="p">.</span><span class="n">t</span><span class="p">()</span> <span class="o">*</span> <span class="n">Q</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">c</span><span class="p">.</span><span class="n">t</span><span class="p">()</span> <span class="o">*</span> <span class="n">y</span><span class="p">;</span>
  <span class="k">return</span> <span class="nf">obj</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span><span class="o">::</span><span class="n">save</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">filename</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">erase</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="n">Utils</span><span class="o">::</span><span class="n">appendSave</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;QP_Param&quot;</span><span class="p">),</span> <span class="n">filename</span><span class="p">,</span> <span class="n">erase</span><span class="p">);</span>
  <span class="n">Utils</span><span class="o">::</span><span class="n">appendSave</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Q</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;QP_Param::Q&quot;</span><span class="p">),</span> <span class="nb">false</span><span class="p">);</span>
  <span class="n">Utils</span><span class="o">::</span><span class="n">appendSave</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">A</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;QP_Param::A&quot;</span><span class="p">),</span> <span class="nb">false</span><span class="p">);</span>
  <span class="n">Utils</span><span class="o">::</span><span class="n">appendSave</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">B</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;QP_Param::B&quot;</span><span class="p">),</span> <span class="nb">false</span><span class="p">);</span>
  <span class="n">Utils</span><span class="o">::</span><span class="n">appendSave</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">C</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;QP_Param::C&quot;</span><span class="p">),</span> <span class="nb">false</span><span class="p">);</span>
  <span class="n">Utils</span><span class="o">::</span><span class="n">appendSave</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">b</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;QP_Param::b&quot;</span><span class="p">),</span> <span class="nb">false</span><span class="p">);</span>
  <span class="n">Utils</span><span class="o">::</span><span class="n">appendSave</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">c</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;QP_Param::c&quot;</span><span class="p">),</span> <span class="nb">false</span><span class="p">);</span>
  <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Saved QP_Param to file &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">filename</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">long</span> <span class="kt">int</span> <span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span><span class="o">::</span><span class="n">load</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">filename</span><span class="p">,</span> <span class="kt">long</span> <span class="kt">int</span> <span class="n">pos</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="n">Q</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">;</span>
  <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">c</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">headercheck</span><span class="p">;</span>
  <span class="n">pos</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">appendRead</span><span class="p">(</span><span class="n">headercheck</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pos</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">headercheck</span> <span class="o">!=</span> <span class="s">&quot;QP_Param&quot;</span><span class="p">)</span>
    <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Error in QP_Param::load: In valid header - &quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">headercheck</span><span class="p">;</span>
  <span class="n">pos</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">appendRead</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;QP_Param::Q&quot;</span><span class="p">));</span>
  <span class="n">pos</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">appendRead</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;QP_Param::A&quot;</span><span class="p">));</span>
  <span class="n">pos</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">appendRead</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;QP_Param::B&quot;</span><span class="p">));</span>
  <span class="n">pos</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">appendRead</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;QP_Param::C&quot;</span><span class="p">));</span>
  <span class="n">pos</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">appendRead</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;QP_Param::b&quot;</span><span class="p">));</span>
  <span class="n">pos</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">appendRead</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;QP_Param::c&quot;</span><span class="p">));</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">set</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">pos</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Game</span><span class="o">::</span><span class="n">NashGame</span><span class="o">::</span><span class="n">NashGame</span><span class="p">(</span><span class="n">GRBEnv</span> <span class="o">*</span><span class="n">e</span><span class="p">,</span>
                         <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">QP_Param</span><span class="o">&gt;&gt;</span> <span class="n">players</span><span class="p">,</span>
                         <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="n">MC</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">MCRHS</span><span class="p">,</span>
                         <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nLeadVar</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="n">leadA</span><span class="p">,</span>
                         <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">leadRHS</span><span class="p">)</span>
    <span class="o">:</span> <span class="n">Env</span><span class="p">{</span><span class="n">e</span><span class="p">},</span> <span class="n">LeaderConstraints</span><span class="p">{</span><span class="n">leadA</span><span class="p">},</span> <span class="n">LeaderConstraintsRHS</span><span class="p">{</span><span class="n">leadRHS</span><span class="p">}</span>
<span class="p">{</span>
  <span class="c1">// Setting the class variables</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">numLeaderVar</span> <span class="o">=</span> <span class="n">nLeadVar</span><span class="p">;</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span> <span class="o">=</span> <span class="n">players</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">Players</span> <span class="o">=</span> <span class="n">players</span><span class="p">;</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">MarketClearing</span> <span class="o">=</span> <span class="n">MC</span><span class="p">;</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">MCRHS</span> <span class="o">=</span> <span class="n">MCRHS</span><span class="p">;</span>
  <span class="c1">// Setting the size of class variable std::vectors</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">setPositions</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">Game</span><span class="o">::</span><span class="n">NashGame</span><span class="o">::</span><span class="n">NashGame</span><span class="p">(</span><span class="k">const</span> <span class="n">NashGame</span> <span class="o">&amp;</span><span class="n">N</span><span class="p">)</span>
    <span class="o">:</span> <span class="n">Env</span><span class="p">{</span><span class="n">N</span><span class="p">.</span><span class="n">Env</span><span class="p">},</span> <span class="n">LeaderConstraints</span><span class="p">{</span><span class="n">N</span><span class="p">.</span><span class="n">LeaderConstraints</span><span class="p">},</span>
      <span class="n">LeaderConstraintsRHS</span><span class="p">{</span><span class="n">N</span><span class="p">.</span><span class="n">LeaderConstraintsRHS</span><span class="p">},</span> <span class="n">NumPlayers</span><span class="p">{</span><span class="n">N</span><span class="p">.</span><span class="n">NumPlayers</span><span class="p">},</span>
      <span class="n">Players</span><span class="p">{</span><span class="n">N</span><span class="p">.</span><span class="n">Players</span><span class="p">},</span> <span class="n">MarketClearing</span><span class="p">{</span><span class="n">N</span><span class="p">.</span><span class="n">MarketClearing</span><span class="p">},</span> <span class="n">MCRHS</span><span class="p">{</span><span class="n">N</span><span class="p">.</span><span class="n">MCRHS</span><span class="p">},</span>
      <span class="n">numLeaderVar</span><span class="p">{</span><span class="n">N</span><span class="p">.</span><span class="n">numLeaderVar</span><span class="p">}</span> <span class="p">{</span>
  <span class="c1">// Setting the size of class variable std::vectors</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">setPositions</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Game</span><span class="o">::</span><span class="n">NashGame</span><span class="o">::</span><span class="n">save</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">filename</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">erase</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="n">Utils</span><span class="o">::</span><span class="n">appendSave</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;NashGame&quot;</span><span class="p">),</span> <span class="n">filename</span><span class="p">,</span> <span class="n">erase</span><span class="p">);</span>
  <span class="n">Utils</span><span class="o">::</span><span class="n">appendSave</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span>
                    <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;NashGame::NumPlayers&quot;</span><span class="p">),</span> <span class="nb">false</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">Players</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
  <span class="n">Utils</span><span class="o">::</span><span class="n">appendSave</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">MarketClearing</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span>
                    <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;NashGame::MarketClearing&quot;</span><span class="p">),</span> <span class="nb">false</span><span class="p">);</span>
  <span class="n">Utils</span><span class="o">::</span><span class="n">appendSave</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">MCRHS</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;NashGame::MCRHS&quot;</span><span class="p">),</span>
                    <span class="nb">false</span><span class="p">);</span>
  <span class="n">Utils</span><span class="o">::</span><span class="n">appendSave</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderConstraints</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span>
                    <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;NashGame::LeaderConstraints&quot;</span><span class="p">),</span> <span class="nb">false</span><span class="p">);</span>
  <span class="n">Utils</span><span class="o">::</span><span class="n">appendSave</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderConstraintsRHS</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span>
                    <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;NashGame::LeaderConstraintsRHS&quot;</span><span class="p">),</span> <span class="nb">false</span><span class="p">);</span>
  <span class="n">Utils</span><span class="o">::</span><span class="n">appendSave</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">numLeaderVar</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span>
                    <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;NashGame::numLeaderVar&quot;</span><span class="p">),</span> <span class="nb">false</span><span class="p">);</span>
  <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Saved NashGame to file &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">filename</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">long</span> <span class="kt">int</span> <span class="n">Game</span><span class="o">::</span><span class="n">NashGame</span><span class="o">::</span><span class="n">load</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">filename</span><span class="p">,</span> <span class="kt">long</span> <span class="kt">int</span> <span class="n">pos</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Env</span><span class="p">)</span>
    <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Error in NashGame::load: To load NashGame from file, it has &quot;</span>
          <span class="s">&quot;to be constructed using NashGame(GRBEnv*) constructor&quot;</span><span class="p">);</span>
  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">headercheck</span><span class="p">;</span>
  <span class="n">pos</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">appendRead</span><span class="p">(</span><span class="n">headercheck</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pos</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">headercheck</span> <span class="o">!=</span> <span class="s">&quot;NashGame&quot;</span><span class="p">)</span>
    <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Error in NashGame::load: In valid header - &quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">headercheck</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">numPlayersLocal</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">pos</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">appendRead</span><span class="p">(</span><span class="n">numPlayersLocal</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span>
                          <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;NashGame::NumPlayers&quot;</span><span class="p">));</span>
  <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">QP_Param</span><span class="o">&gt;&gt;</span> <span class="n">players</span><span class="p">;</span>
  <span class="n">players</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">numPlayersLocal</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">numPlayersLocal</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Players.at(i) = std::make_shared&lt;Game::QP_Param&gt;(this-&gt;Env);</span>
    <span class="k">auto</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span><span class="o">&gt;</span><span class="p">(</span><span class="k">new</span> <span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Env</span><span class="p">));</span>
    <span class="n">players</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp</span><span class="p">;</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">players</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">pos</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="n">marketClearing</span><span class="p">;</span>
  <span class="n">pos</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">appendRead</span><span class="p">(</span><span class="n">marketClearing</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span>
                          <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;NashGame::MarketClearing&quot;</span><span class="p">));</span>
  <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">mcrhs</span><span class="p">;</span>
  <span class="n">pos</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">appendRead</span><span class="p">(</span><span class="n">mcrhs</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;NashGame::MCRHS&quot;</span><span class="p">));</span>
  <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="n">leaderConstraints</span><span class="p">;</span>
  <span class="n">pos</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">appendRead</span><span class="p">(</span><span class="n">leaderConstraints</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span>
                          <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;NashGame::LeaderConstraints&quot;</span><span class="p">));</span>
  <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">leaderConsRHS</span><span class="p">;</span>
  <span class="n">pos</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">appendRead</span><span class="p">(</span><span class="n">leaderConsRHS</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span>
                          <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;NashGame::LeaderConstraintsRHS&quot;</span><span class="p">));</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">numLeadConstraints</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">pos</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">appendRead</span><span class="p">(</span><span class="n">numLeadConstraints</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span>
                          <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;NashGame::numLeaderVar&quot;</span><span class="p">));</span>
  <span class="c1">// Setting the class variables</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">numLeaderVar</span> <span class="o">=</span> <span class="n">numLeadConstraints</span><span class="p">;</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">Players</span> <span class="o">=</span> <span class="n">players</span><span class="p">;</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span> <span class="o">=</span> <span class="n">numPlayersLocal</span><span class="p">;</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">MarketClearing</span> <span class="o">=</span> <span class="n">marketClearing</span><span class="p">;</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">MCRHS</span> <span class="o">=</span> <span class="n">mcrhs</span><span class="p">;</span>
  <span class="c1">// Setting the size of class variable std::vectors</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">setPositions</span><span class="p">();</span>
  <span class="k">return</span> <span class="n">pos</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Game</span><span class="o">::</span><span class="n">NashGame</span><span class="o">::</span><span class="n">setPositions</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">// Defining the variable value</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">prCnt</span><span class="p">{</span><span class="mi">0</span><span class="p">},</span>
      <span class="n">dlCnt</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span> <span class="c1">// Temporary variables - primal count and dual count</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">NumPlayers</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">prCnt</span><span class="p">;</span>
    <span class="n">prCnt</span> <span class="o">+=</span> <span class="n">Players</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">getNy</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="c1">// Pushing back the end of primal position</span>
  <span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">NumPlayers</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">prCnt</span><span class="p">);</span>
  <span class="n">dlCnt</span> <span class="o">=</span> <span class="n">prCnt</span><span class="p">;</span> <span class="c1">// From now on, the space is for dual variables.</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">MC_DualPosition</span> <span class="o">=</span> <span class="n">dlCnt</span><span class="p">;</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderPosition</span> <span class="o">=</span> <span class="n">dlCnt</span> <span class="o">+</span> <span class="n">MCRHS</span><span class="p">.</span><span class="n">n_rows</span><span class="p">;</span>
  <span class="n">dlCnt</span> <span class="o">+=</span> <span class="p">(</span><span class="n">MCRHS</span><span class="p">.</span><span class="n">n_rows</span> <span class="o">+</span> <span class="n">numLeaderVar</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">NumPlayers</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">dlCnt</span><span class="p">;</span>
    <span class="n">dlCnt</span> <span class="o">+=</span> <span class="n">Players</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">getb</span><span class="p">().</span><span class="n">n_rows</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">// Pushing back the end of dual position</span>
  <span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">NumPlayers</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">dlCnt</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">const</span> <span class="n">Game</span><span class="o">::</span><span class="n">NashGame</span> <span class="o">&amp;</span><span class="n">Game</span><span class="o">::</span><span class="n">NashGame</span><span class="o">::</span><span class="n">formulateLCP</span><span class="p">(</span>
    <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="o">&amp;</span><span class="n">M</span><span class="p">,</span>
    <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">q</span><span class="p">,</span>
    <span class="n">perps</span> <span class="o">&amp;</span><span class="n">Compl</span><span class="p">,</span>
    <span class="kt">bool</span> <span class="n">writeToFile</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">M_name</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">q_name</span>
<span class="p">)</span> <span class="k">const</span> <span class="p">{</span>

  <span class="c1">// To store the individual KKT conditions for each player.</span>
  <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span><span class="o">&gt;</span> <span class="n">Mi</span><span class="p">(</span><span class="n">NumPlayers</span><span class="p">),</span> <span class="n">Ni</span><span class="p">(</span><span class="n">NumPlayers</span><span class="p">);</span>
  <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">arma</span><span class="o">::</span><span class="n">vec</span><span class="o">&gt;</span> <span class="n">qi</span><span class="p">(</span><span class="n">NumPlayers</span><span class="p">);</span>

  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">numVarFollow</span><span class="p">{</span><span class="mi">0</span><span class="p">},</span> <span class="n">numVarLead</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
  <span class="n">numVarLead</span> <span class="o">=</span>
      <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">back</span><span class="p">();</span> <span class="c1">// Number of Leader variables (all variables)</span>
  <span class="c1">// Below is not strictly the follower variables,</span>
  <span class="c1">// But the count of set of variables which don&#39;t have</span>
  <span class="c1">// a matching complementarity eqn</span>
  <span class="n">numVarFollow</span> <span class="o">=</span> <span class="n">numVarLead</span> <span class="o">-</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">numLeaderVar</span><span class="p">;</span>
  <span class="n">M</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">numVarFollow</span><span class="p">,</span> <span class="n">numVarLead</span><span class="p">);</span>
  <span class="n">q</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">numVarFollow</span><span class="p">);</span>
  <span class="c1">// Get the KKT conditions for each player</span>

  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">NumPlayers</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">Players</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">KKT</span><span class="p">(</span><span class="n">Mi</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ni</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">qi</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">numPrim</span><span class="p">,</span> <span class="n">numDual</span><span class="p">;</span>
    <span class="n">numPrim</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Players</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">getNy</span><span class="p">();</span>
    <span class="n">numDual</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Players</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">getA</span><span class="p">().</span><span class="n">n_rows</span><span class="p">;</span>
    <span class="c1">// Adding the primal equations</span>
    <span class="c1">// Region 1 in Formulate LCP.ipe</span>
    <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::NashGame::formulateLCP: Region 1&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// For the first player, no need to add anything &#39;before&#39; 0-th</span>
      <span class="c1">// position</span>
      <span class="n">M</span><span class="p">.</span><span class="n">submat</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span>
               <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
               <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span>
          <span class="n">Ni</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">submat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">numPrim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">// Region 2 in Formulate LCP.ipe</span>
    <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::NashGame::formulateLCP: Region 2&quot;</span><span class="p">;</span>
    <span class="n">M</span><span class="p">.</span><span class="n">submat</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
             <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
             <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span>
        <span class="n">Mi</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">submat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">numPrim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">numPrim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
    <span class="c1">// Region 3 in Formulate LCP.ipe</span>
    <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::NashGame::formulateLCP: Region 3&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">M</span><span class="p">.</span><span class="n">submat</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
               <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
               <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span>
          <span class="n">Ni</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">submat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">numPrim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                       <span class="n">Ni</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">n_cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">// Region 4 in Formulate LCP.ipe</span>
    <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::NashGame::formulateLCP: Region 4&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">!=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">M</span><span class="p">.</span><span class="n">submat</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
               <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
               <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span>
          <span class="n">Mi</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">submat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">numPrim</span><span class="p">,</span> <span class="n">numPrim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">numPrim</span> <span class="o">+</span> <span class="n">numDual</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">// RHS</span>
    <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::NashGame::formulateLCP: Region RHS&quot;</span><span class="p">;</span>
    <span class="n">q</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span>
        <span class="n">qi</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">subvec</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">numPrim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
         <span class="n">j</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
      <span class="n">Compl</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">});</span>
    <span class="c1">// Adding the dual equations</span>
    <span class="c1">// Region 5 in Formulate LCP.ipe</span>
    <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::NashGame::formulateLCP: Region 5&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">numDual</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">// For the first player, no need to add anything &#39;before&#39; 0-th</span>
        <span class="c1">// position</span>
        <span class="n">M</span><span class="p">.</span><span class="n">submat</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">numLeaderVar</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                 <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">numLeaderVar</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                 <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span>
            <span class="n">Ni</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">submat</span><span class="p">(</span><span class="n">numPrim</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Ni</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">n_rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                         <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
      <span class="c1">// Region 6 in Formulate LCP.ipe</span>
      <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::NashGame::formulateLCP: Region 6&quot;</span><span class="p">;</span>
      <span class="n">M</span><span class="p">.</span><span class="n">submat</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">numLeaderVar</span><span class="p">,</span>
               <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
               <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">numLeaderVar</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
               <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span>
          <span class="n">Mi</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">submat</span><span class="p">(</span><span class="n">numPrim</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">numPrim</span> <span class="o">+</span> <span class="n">numDual</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">numPrim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
      <span class="c1">// Region 7 in Formulate LCP.ipe</span>
      <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::NashGame::formulateLCP: Region 7&quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">M</span><span class="p">.</span><span class="n">submat</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">numLeaderVar</span><span class="p">,</span>
                 <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                 <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">numLeaderVar</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                 <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span>
            <span class="n">Ni</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">submat</span><span class="p">(</span><span class="n">numPrim</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">Ni</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">n_rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                         <span class="n">Ni</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">n_cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="c1">// Region 8 in Formulate LCP.ipe</span>
      <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::NashGame::formulateLCP: Region 8&quot;</span><span class="p">;</span>
      <span class="n">M</span><span class="p">.</span><span class="n">submat</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">numLeaderVar</span><span class="p">,</span>
               <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
               <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">numLeaderVar</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
               <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span>
          <span class="n">Mi</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">submat</span><span class="p">(</span><span class="n">numPrim</span><span class="p">,</span> <span class="n">numPrim</span><span class="p">,</span> <span class="n">numPrim</span> <span class="o">+</span> <span class="n">numDual</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                       <span class="n">numPrim</span> <span class="o">+</span> <span class="n">numDual</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
      <span class="c1">// RHS</span>
      <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::NashGame::formulateLCP: Region RHS&quot;</span><span class="p">;</span>
      <span class="n">q</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">numLeaderVar</span><span class="p">,</span>
               <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">numLeaderVar</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span>
          <span class="n">qi</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">subvec</span><span class="p">(</span><span class="n">numPrim</span><span class="p">,</span> <span class="n">qi</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">n_rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
      <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">numLeaderVar</span><span class="p">;</span>
           <span class="n">j</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">numLeaderVar</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
        <span class="n">Compl</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="n">numLeaderVar</span><span class="p">});</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::NashGame::formulateLCP: MC RHS&quot;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">MCRHS</span><span class="p">.</span><span class="n">n_elem</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">// It is possible that it is a Cournot game and</span>
                               <span class="c1">// there are no MC conditions!</span>
  <span class="p">{</span>
    <span class="n">M</span><span class="p">.</span><span class="n">submat</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">MC_DualPosition</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderPosition</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
             <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">MarketClearing</span><span class="p">;</span>
    <span class="n">q</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">MC_DualPosition</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderPosition</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">MCRHS</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">MC_DualPosition</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderPosition</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
      <span class="n">Compl</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">});</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">writeToFile</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">M</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">M_name</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">coord_ascii</span><span class="p">);</span>
    <span class="n">q</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">q_name</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">arma_ascii</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="n">Game</span><span class="o">::</span><span class="n">NashGame</span><span class="o">::</span><span class="n">rewriteLeadCons</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
  <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="n">A_in</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderConstraints</span><span class="p">;</span>
  <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="n">A_out_expl</span><span class="p">,</span> <span class="n">A_out_MC</span><span class="p">,</span> <span class="n">A_out</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">NvarLead</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
  <span class="n">NvarLead</span> <span class="o">=</span>
      <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">back</span><span class="p">();</span> <span class="c1">// Number of Leader variables (all variables)</span>
  <span class="c1">// NvarFollow = NvarLead - this-&gt;numLeaderVar;</span>

  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n_Row</span><span class="p">,</span> <span class="n">n_Col</span><span class="p">;</span>
  <span class="n">n_Row</span> <span class="o">=</span> <span class="n">A_in</span><span class="p">.</span><span class="n">n_rows</span><span class="p">;</span>
  <span class="n">n_Col</span> <span class="o">=</span> <span class="n">A_in</span><span class="p">.</span><span class="n">n_cols</span><span class="p">;</span>
  <span class="n">A_out_expl</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_Row</span><span class="p">,</span> <span class="n">NvarLead</span><span class="p">);</span>
  <span class="n">A_out_MC</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">MarketClearing</span><span class="p">.</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">NvarLead</span><span class="p">);</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">A_in</span><span class="p">.</span><span class="n">n_rows</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Primal variables i.e., everything before MCduals are the same!</span>
      <span class="n">A_out_expl</span><span class="p">.</span><span class="n">cols</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">MC_DualPosition</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span>
          <span class="n">A_in</span><span class="p">.</span><span class="n">cols</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">MC_DualPosition</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
      <span class="n">A_out_expl</span><span class="p">.</span><span class="n">cols</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderPosition</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span>
          <span class="n">A_in</span><span class="p">.</span><span class="n">cols</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">MC_DualPosition</span><span class="p">,</span> <span class="n">n_Col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">MCRHS</span><span class="p">.</span><span class="n">n_rows</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// MC constraints can be written as if they are leader constraints</span>
      <span class="n">A_out_MC</span><span class="p">.</span><span class="n">submat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">MCRHS</span><span class="p">.</span><span class="n">n_rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                      <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">MarketClearing</span><span class="p">;</span>
      <span class="n">A_out_MC</span><span class="p">.</span><span class="n">submat</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">MCRHS</span><span class="p">.</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">MCRHS</span><span class="p">.</span><span class="n">n_rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                      <span class="k">this</span><span class="o">-&gt;</span><span class="n">DualPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">MarketClearing</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">arma</span><span class="o">::</span><span class="n">join_cols</span><span class="p">(</span><span class="n">A_out_expl</span><span class="p">,</span> <span class="n">A_out_MC</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error in NashGame::rewriteLeadCons: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;String: Error in NashGame::rewriteLeadCons: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">exception</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Exception: Error in NashGame::rewriteLeadCons: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">()</span>
              <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">Game</span><span class="o">::</span><span class="n">NashGame</span> <span class="o">&amp;</span><span class="n">Game</span><span class="o">::</span><span class="n">NashGame</span><span class="o">::</span><span class="n">addDummy</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">par</span><span class="p">,</span> <span class="kt">int</span> <span class="n">position</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="nl">q</span> <span class="p">:</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Players</span><span class="p">)</span>
    <span class="n">q</span><span class="o">-&gt;</span><span class="n">addDummy</span><span class="p">(</span><span class="n">par</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">position</span><span class="p">);</span>

  <span class="k">this</span><span class="o">-&gt;</span><span class="n">numLeaderVar</span> <span class="o">+=</span> <span class="n">par</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderConstraints</span><span class="p">.</span><span class="n">n_rows</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">auto</span> <span class="n">nnR</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderConstraints</span><span class="p">.</span><span class="n">n_rows</span><span class="p">;</span>
    <span class="k">auto</span> <span class="n">nnC</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderConstraints</span><span class="p">.</span><span class="n">n_cols</span><span class="p">;</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">position</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">-</span><span class="mi">1</span><span class="o">:</span>
      <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderConstraints</span> <span class="o">=</span>
          <span class="n">Utils</span><span class="o">::</span><span class="n">resizePatch</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderConstraints</span><span class="p">,</span> <span class="n">nnR</span><span class="p">,</span> <span class="n">nnC</span> <span class="o">+</span> <span class="n">par</span><span class="p">);</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>
      <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderConstraints</span> <span class="o">=</span> <span class="n">arma</span><span class="o">::</span><span class="n">join_rows</span><span class="p">(</span>
          <span class="n">arma</span><span class="o">::</span><span class="n">zeros</span><span class="o">&lt;</span><span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span><span class="o">&gt;</span><span class="p">(</span><span class="n">nnR</span><span class="p">,</span> <span class="n">par</span><span class="p">),</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderConstraints</span><span class="p">);</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">default</span><span class="o">:</span>
      <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="n">lC</span> <span class="o">=</span> <span class="n">arma</span><span class="o">::</span><span class="n">join_rows</span><span class="p">(</span><span class="n">LeaderConstraints</span><span class="p">.</span><span class="n">cols</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">position</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
                                        <span class="n">arma</span><span class="o">::</span><span class="n">zeros</span><span class="o">&lt;</span><span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span><span class="o">&gt;</span><span class="p">(</span><span class="n">nnR</span><span class="p">,</span> <span class="n">par</span><span class="p">));</span>

      <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderConstraints</span> <span class="o">=</span>
          <span class="n">arma</span><span class="o">::</span><span class="n">join_rows</span><span class="p">(</span><span class="n">lC</span><span class="p">,</span> <span class="n">LeaderConstraints</span><span class="p">.</span><span class="n">cols</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">nnC</span> <span class="o">-</span> <span class="mi">1</span><span class="p">));</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="p">};</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">MarketClearing</span><span class="p">.</span><span class="n">n_rows</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">auto</span> <span class="n">nnR</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">MarketClearing</span><span class="p">.</span><span class="n">n_rows</span><span class="p">;</span>
    <span class="k">auto</span> <span class="n">nnC</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">MarketClearing</span><span class="p">.</span><span class="n">n_cols</span><span class="p">;</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">position</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">-</span><span class="mi">1</span><span class="o">:</span>
      <span class="k">this</span><span class="o">-&gt;</span><span class="n">MarketClearing</span> <span class="o">=</span>
          <span class="n">Utils</span><span class="o">::</span><span class="n">resizePatch</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">MarketClearing</span><span class="p">,</span> <span class="n">nnR</span><span class="p">,</span> <span class="n">nnC</span> <span class="o">+</span> <span class="n">par</span><span class="p">);</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">default</span><span class="o">:</span>
      <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
          <span class="o">&lt;&lt;</span> <span class="s">&quot;addDummy at non-final position not implemented&quot;</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">setPositions</span><span class="p">();</span>
  <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Game</span><span class="o">::</span><span class="n">NashGame</span> <span class="o">&amp;</span><span class="n">Game</span><span class="o">::</span><span class="n">NashGame</span><span class="o">::</span><span class="n">addLeadCons</span><span class="p">(</span><span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="kt">double</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">auto</span> <span class="n">nC</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderConstraints</span><span class="p">.</span><span class="n">n_cols</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">n_elem</span> <span class="o">!=</span> <span class="n">nC</span><span class="p">)</span>
    <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Error in NashGame::addLeadCons: Leader constraint size &quot;</span>
          <span class="s">&quot;incompatible --- &quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">n_elem</span><span class="p">)</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot; != &quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">nC</span><span class="p">);</span>
  <span class="k">auto</span> <span class="n">nR</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderConstraints</span><span class="p">.</span><span class="n">n_rows</span><span class="p">;</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderConstraints</span> <span class="o">=</span>
      <span class="n">Utils</span><span class="o">::</span><span class="n">resizePatch</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderConstraints</span><span class="p">,</span> <span class="n">nR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nC</span><span class="p">);</span>
  <span class="c1">// (static_cast&lt;arma::mat&gt;(a)).t();   // Apparently this is not reqd! a.t()</span>
  <span class="c1">// already works in newer versions of armadillo</span>
  <span class="n">LeaderConstraints</span><span class="p">.</span><span class="n">row</span><span class="p">(</span><span class="n">nR</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">t</span><span class="p">();</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderConstraintsRHS</span> <span class="o">=</span>
      <span class="n">Utils</span><span class="o">::</span><span class="n">resizePatch</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderConstraintsRHS</span><span class="p">,</span> <span class="n">nR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderConstraintsRHS</span><span class="p">(</span><span class="n">nR</span><span class="p">)</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span>
  <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Game</span><span class="o">::</span><span class="n">NashGame</span><span class="o">::</span><span class="n">write</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">filename</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">append</span><span class="p">,</span>
                           <span class="kt">bool</span> <span class="n">KKT</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">ofstream</span> <span class="n">file</span><span class="p">;</span>
  <span class="n">file</span><span class="p">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s">&quot;.nash&quot;</span><span class="p">,</span> <span class="n">append</span> <span class="o">?</span> <span class="n">arma</span><span class="o">::</span><span class="n">ios</span><span class="o">::</span><span class="nl">app</span> <span class="p">:</span> <span class="n">arma</span><span class="o">::</span><span class="n">ios</span><span class="o">::</span><span class="n">out</span><span class="p">);</span>
  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n\n\n\n\n\n\n</span><span class="s">&quot;</span><span class="p">;</span>
  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">LeaderConstraints: &quot;</span> <span class="o">&lt;&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderConstraints</span><span class="p">;</span>
  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">LeaderConstraintsRHS</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">&lt;&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderConstraintsRHS</span><span class="p">;</span>
  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">MarketClearing: &quot;</span> <span class="o">&lt;&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">MarketClearing</span><span class="p">;</span>
  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">MCRHS</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">&lt;&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">MCRHS</span><span class="p">;</span>

  <span class="n">file</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

  <span class="c1">// this-&gt;LeaderConstraints.save(filename+&quot;_LeaderConstraints.txt&quot;,</span>
  <span class="c1">// arma::file_type::arma_ascii);</span>
  <span class="c1">// this-&gt;LeaderConstraintsRHS.save(filename+&quot;_LeaderConsRHS.txt&quot;,</span>
  <span class="c1">// arma::file_type::arma_ascii);</span>
  <span class="c1">// this-&gt;MarketClearing.save(filename+&quot;_MarketClearing.txt&quot;,</span>
  <span class="c1">// arma::file_type::arma_ascii); this-&gt;MCRHS.save(filename+&quot;_MCRHS.txt&quot;,</span>
  <span class="c1">// arma::file_type::arma_ascii);</span>

  <span class="kt">int</span> <span class="n">count</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
  <span class="k">for</span> <span class="p">(</span><span class="k">const</span> <span class="k">auto</span> <span class="o">&amp;</span><span class="nl">pl</span> <span class="p">:</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Players</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// pl-&gt;QP_Param::write(filename+&quot;_Players_&quot;+to_string(count++), append);</span>
    <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;--------------------------------------------------</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
    <span class="n">file</span><span class="p">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s">&quot;.nash&quot;</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">ios</span><span class="o">::</span><span class="n">app</span><span class="p">);</span>
    <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n\n\n\n</span><span class="s"> PLAYER &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">count</span><span class="o">++</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">;</span>
    <span class="n">file</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
    <span class="n">pl</span><span class="o">-&gt;</span><span class="n">QP_Param</span><span class="o">::</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s">&quot;.nash&quot;</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">file</span><span class="p">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s">&quot;.nash&quot;</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">ios</span><span class="o">::</span><span class="n">app</span><span class="p">);</span>
  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;--------------------------------------------------</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Primal Positions:</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="k">const</span> <span class="k">auto</span> <span class="nl">pos</span> <span class="p">:</span> <span class="n">PrimalPosition</span><span class="p">)</span>
    <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">pos</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;  &quot;</span><span class="p">;</span>
  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Dual Positions:</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="k">const</span> <span class="k">auto</span> <span class="nl">pos</span> <span class="p">:</span> <span class="n">DualPosition</span><span class="p">)</span>
    <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">pos</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;  &quot;</span><span class="p">;</span>
  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">MC dual position:</span><span class="se">\t</span><span class="s">&quot;</span> <span class="o">&lt;&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">MC_DualPosition</span><span class="p">;</span>
  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Leader position:</span><span class="se">\t</span><span class="s">&quot;</span> <span class="o">&lt;&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderPosition</span><span class="p">;</span>
  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">numberLeader:</span><span class="se">\t</span><span class="s">&quot;</span> <span class="o">&lt;&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">numLeaderVar</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">KKT</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="n">M</span><span class="p">;</span>
    <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">q</span><span class="p">;</span>
    <span class="n">perps</span> <span class="n">Compl</span><span class="p">;</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">formulateLCP</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">Compl</span><span class="p">);</span>
    <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n\n\n</span><span class="s"> KKT CONDITIONS - LCP</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
    <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">M: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">M</span><span class="p">;</span>
    <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">q:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">q</span><span class="p">;</span>
    <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s"> Complementarities:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">const</span> <span class="k">auto</span> <span class="o">&amp;</span><span class="nl">p</span> <span class="p">:</span> <span class="n">Compl</span><span class="p">)</span>
      <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;&lt;&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">first</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;&gt;&quot;</span>
           <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n</span><span class="s">&quot;</span><span class="p">;</span>

  <span class="n">file</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">GRBModel</span><span class="o">&gt;</span> <span class="n">Game</span><span class="o">::</span><span class="n">NashGame</span><span class="o">::</span><span class="n">respond</span><span class="p">(</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">player</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span>
    <span class="kt">bool</span> <span class="n">fullvec</span>
<span class="p">)</span> <span class="k">const</span>
<span class="p">{</span>
  <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">solOther</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nVar</span><span class="p">{</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">getNprimals</span><span class="p">()</span> <span class="o">+</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">getNumShadow</span><span class="p">()</span> <span class="o">+</span>
                    <span class="k">this</span><span class="o">-&gt;</span><span class="n">getNumLeaderVars</span><span class="p">()};</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nStart</span><span class="p">,</span> <span class="n">nEnd</span><span class="p">;</span>
  <span class="n">nStart</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span>
      <span class="n">player</span><span class="p">);</span> <span class="c1">// Start of the player-th player&#39;s primals</span>
  <span class="n">nEnd</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span>
      <span class="n">player</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// Start of the player+1-th player&#39;s primals or LeaderVrs if</span>
  <span class="c1">// player is the last player.</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">fullvec</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">solOther</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nVar</span> <span class="o">-</span> <span class="n">nEnd</span> <span class="o">+</span> <span class="n">nStart</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">nStart</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
      <span class="n">solOther</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nStart</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nStart</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">nEnd</span> <span class="o">&lt;</span> <span class="n">nVar</span><span class="p">)</span>
      <span class="n">solOther</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="n">nStart</span><span class="p">,</span> <span class="n">nVar</span> <span class="o">+</span> <span class="n">nStart</span> <span class="o">-</span> <span class="n">nEnd</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span>
          <span class="n">x</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="n">nEnd</span><span class="p">,</span>
                   <span class="n">nVar</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// Discard any dual variables in x</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">solOther</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nVar</span> <span class="o">-</span> <span class="n">nEnd</span> <span class="o">+</span> <span class="n">nStart</span><span class="p">);</span>
    <span class="n">solOther</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nVar</span> <span class="o">-</span> <span class="n">nEnd</span> <span class="o">+</span> <span class="n">nStart</span> <span class="o">-</span>
                               <span class="mi">1</span><span class="p">);</span> <span class="c1">// Discard any dual variables in x</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Players</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">player</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">solveFixed</span><span class="p">(</span><span class="n">solOther</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">double</span> <span class="n">Game</span><span class="o">::</span><span class="n">NashGame</span><span class="o">::</span><span class="n">respondSol</span><span class="p">(</span>
    <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">sol</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">player</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span>
    <span class="kt">bool</span> <span class="n">fullvec</span>
<span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="k">auto</span> <span class="n">model</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">respond</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">fullvec</span><span class="p">);</span>
  <span class="c1">// Check if the model is solved optimally</span>
  <span class="k">const</span> <span class="kt">int</span> <span class="n">status</span> <span class="o">=</span> <span class="n">model</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">(</span><span class="n">GRB_IntAttr_Status</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">==</span> <span class="n">GRB_OPTIMAL</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">Nx</span> <span class="o">=</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">player</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">player</span><span class="p">);</span>
    <span class="n">sol</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nx</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">Nx</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
      <span class="n">sol</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span>
          <span class="n">model</span><span class="o">-&gt;</span><span class="n">getVarByName</span><span class="p">(</span><span class="s">&quot;y_&quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">i</span><span class="p">)).</span><span class="n">get</span><span class="p">(</span><span class="n">GRB_DoubleAttr_X</span><span class="p">);</span>

    <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::NashGame::RespondSol: Player&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">player</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">model</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">(</span><span class="n">GRB_DoubleAttr_ObjVal</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span>
    <span class="k">return</span> <span class="n">GRB_INFINITY</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">Game</span><span class="o">::</span><span class="n">NashGame</span><span class="o">::</span><span class="n">computeQPObjectiveValues</span><span class="p">(</span><span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span>
                                                   <span class="kt">bool</span> <span class="n">checkFeas</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">vals</span><span class="p">;</span>
  <span class="n">vals</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nVar</span><span class="p">{</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">getNprimals</span><span class="p">()</span> <span class="o">+</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">getNumShadow</span><span class="p">()</span> <span class="o">+</span>
                      <span class="k">this</span><span class="o">-&gt;</span><span class="n">getNumLeaderVars</span><span class="p">()};</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nStart</span><span class="p">,</span> <span class="n">nEnd</span><span class="p">;</span>
    <span class="n">nStart</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="n">nEnd</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">x_i</span><span class="p">,</span> <span class="n">x_minus_i</span><span class="p">;</span>

    <span class="n">x_minus_i</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nVar</span> <span class="o">-</span> <span class="n">nEnd</span> <span class="o">+</span> <span class="n">nStart</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">nStart</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">x_minus_i</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nStart</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nStart</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">nEnd</span> <span class="o">&lt;</span> <span class="n">nVar</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">x_minus_i</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="n">nStart</span><span class="p">,</span> <span class="n">nVar</span> <span class="o">+</span> <span class="n">nStart</span> <span class="o">-</span> <span class="n">nEnd</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span>
          <span class="n">x</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="n">nEnd</span><span class="p">,</span> <span class="n">nVar</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// Discard any dual variables in x</span>
    <span class="p">}</span>

    <span class="n">x_i</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="n">nStart</span><span class="p">,</span> <span class="n">nEnd</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">vals</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">Players</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">computeObjective</span><span class="p">(</span><span class="n">x_i</span><span class="p">,</span> <span class="n">x_minus_i</span><span class="p">,</span> <span class="n">checkFeas</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="n">vals</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">Game</span><span class="o">::</span><span class="n">NashGame</span><span class="o">::</span><span class="n">computeQPObjectiveValuesWithoutOthers</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">vals</span><span class="p">;</span>
  <span class="n">vals</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nVar</span><span class="p">{</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">getNprimals</span><span class="p">()</span> <span class="o">+</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">getNumShadow</span><span class="p">()</span> <span class="o">+</span>
                      <span class="k">this</span><span class="o">-&gt;</span><span class="n">getNumLeaderVars</span><span class="p">()};</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nStart</span><span class="p">,</span> <span class="n">nEnd</span><span class="p">;</span>
    <span class="n">nStart</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="n">nEnd</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PrimalPosition</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">x_i</span><span class="p">,</span> <span class="n">x_minus_i</span><span class="p">;</span>

    <span class="n">x_minus_i</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nVar</span> <span class="o">-</span> <span class="n">nEnd</span> <span class="o">+</span> <span class="n">nStart</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">nStart</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">x_minus_i</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nStart</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nStart</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">nEnd</span> <span class="o">&lt;</span> <span class="n">nVar</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">x_minus_i</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="n">nStart</span><span class="p">,</span> <span class="n">nVar</span> <span class="o">+</span> <span class="n">nStart</span> <span class="o">-</span> <span class="n">nEnd</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span>
          <span class="n">x</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="n">nEnd</span><span class="p">,</span> <span class="n">nVar</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// Discard any dual variables in x</span>
    <span class="p">}</span>

    <span class="n">x_i</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="n">nStart</span><span class="p">,</span> <span class="n">nEnd</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">vals</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Players</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">computeObjectiveWithoutOthers</span><span class="p">(</span><span class="n">x_i</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="n">vals</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">Game</span><span class="o">::</span><span class="n">NashGame</span><span class="o">::</span><span class="n">isSolved</span><span class="p">(</span><span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">sol</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">violPlayer</span><span class="p">,</span>
                              <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">violSol</span><span class="p">,</span> <span class="kt">double</span> <span class="n">tol</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">objvals</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">computeQPObjectiveValues</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">double</span> <span class="n">val</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">respondSol</span><span class="p">(</span><span class="n">violSol</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">sol</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="n">GRB_INFINITY</span><span class="p">)</span>
      <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">val</span> <span class="o">-</span> <span class="n">objvals</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">violPlayer</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
      <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// EPEC stuff</span>

<span class="kt">void</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">preFinalize</span><span class="p">()</span>
<span class="p">{}</span>

<span class="kt">void</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">postFinalize</span><span class="p">()</span>
<span class="p">{}</span>

<span class="kt">void</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">finalize</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Finalized</span><span class="p">)</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Warning in Game::EPEC::finalize: Model already Finalized</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

  <span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">getNumLeaders</span><span class="p">();</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">preFinalize</span><span class="p">();</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">ConvexHullVariables</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="p">.</span><span class="n">FeasiblePolyhedra</span> <span class="o">=</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">computeLeaderLocations</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">numMCVariables</span><span class="p">);</span>
    <span class="c1">// Initialize leader objective and PlayersQP</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderObjective</span> <span class="o">=</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Game</span><span class="o">::</span><span class="n">QP_Objective</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">NumPlayers</span><span class="p">);</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderObjectiveConvexHull</span> <span class="o">=</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Game</span><span class="o">::</span><span class="n">QP_Objective</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">NumPlayers</span><span class="p">);</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">PlayersQP</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">NumPlayers</span><span class="p">);</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">PlayersLCP</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Game</span><span class="o">::</span><span class="n">LCP</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">NumPlayers</span><span class="p">);</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">SizesWithoutHull</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">NumPlayers</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="o">-&gt;</span><span class="n">addDummyLead</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
      <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderObjective</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">Game</span><span class="o">::</span><span class="n">QP_Objective</span><span class="o">&gt;</span><span class="p">();</span>
      <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderObjectiveConvexHull</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span>
          <span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">Game</span><span class="o">::</span><span class="n">QP_Objective</span><span class="o">&gt;</span><span class="p">();</span>
      <span class="k">this</span><span class="o">-&gt;</span><span class="n">makeObjectivePlayer</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">*</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderObjective</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">get</span><span class="p">());</span>
      <span class="c1">// this-&gt;PlayersLCP.at(i) =std::shared_ptr&lt;Game::PolyLCP&gt;(new</span>
      <span class="c1">// PolyLCP(this-&gt;Env,*this-&gt;PlayersLowerLevels.at(i).get()));</span>
      <span class="k">this</span><span class="o">-&gt;</span><span class="n">SizesWithoutHull</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="o">*</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LocEnds</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="p">}</span>

  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="n">e</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;String in Game::EPEC::finalize : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">GRBException</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;GRBException in Game::EPEC::finalize : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="n">getErrorCode</span><span class="p">()</span>
              <span class="o">&lt;&lt;</span> <span class="s">&quot;: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="n">getMessage</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">exception</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Exception in Game::EPEC::finalize : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">this</span><span class="o">-&gt;</span><span class="n">Finalized</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>

  <span class="k">this</span><span class="o">-&gt;</span><span class="n">postFinalize</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">addDummyLead</span><span class="p">(</span>
    <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span>
<span class="p">)</span> <span class="p">{</span>
  <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nEPECvars</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">NumVariables</span><span class="p">;</span>
  <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nThisCountryvars</span> <span class="o">=</span> <span class="o">*</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LocEnds</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
  <span class="c1">// this-&gt;Locations.at(i).at(Models::LeaderVars::End);</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">nEPECvars</span> <span class="o">&lt;</span> <span class="n">nThisCountryvars</span><span class="p">)</span>
    <span class="k">throw</span><span class="p">(</span><span class="s">&quot;String in Game::EPEC::addDummyLead: Invalid variable counts &quot;</span> <span class="o">+</span>
          <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">nEPECvars</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; and &quot;</span> <span class="o">+</span>
          <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">nThisCountryvars</span><span class="p">));</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">PlayersLowerLevels</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">get</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">addDummy</span><span class="p">(</span><span class="n">nEPECvars</span> <span class="o">-</span>
                                                   <span class="n">nThisCountryvars</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="n">e</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;String in Game::EPEC::add_Dummy_All_Lead : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">GRBException</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;GRBException in Game::EPEC::add_Dummy_All_Lead : &quot;</span>
              <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="n">getErrorCode</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="n">getMessage</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">exception</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Exception in Game::EPEC::add_Dummy_All_Lead : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">()</span>
              <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">computeLeaderLocations</span><span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">addSpaceForMC</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderLocations</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderLocations</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderLocations</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderLocations</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="o">*</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LocEnds</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">NumVariables</span> <span class="o">=</span>
      <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderLocations</span><span class="p">.</span><span class="n">back</span><span class="p">()</span> <span class="o">+</span> <span class="o">*</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LocEnds</span><span class="p">.</span><span class="n">back</span><span class="p">()</span> <span class="o">+</span> <span class="n">addSpaceForMC</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">getXMinusI</span><span class="p">(</span><span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">i</span><span class="p">,</span>
                            <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">solOther</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nEPECvars</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">NumVariables</span><span class="p">;</span>
  <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nThisCountryvars</span> <span class="o">=</span> <span class="o">*</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LocEnds</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
  <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nThisCountryHullVars</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">ConvexHullVariables</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
  <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nConvexHullVars</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span>
      <span class="n">std</span><span class="o">::</span><span class="n">accumulate</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">ConvexHullVariables</span><span class="p">.</span><span class="n">rbegin</span><span class="p">(),</span>
                      <span class="k">this</span><span class="o">-&gt;</span><span class="n">ConvexHullVariables</span><span class="p">.</span><span class="n">rend</span><span class="p">(),</span> <span class="mi">0</span><span class="p">));</span>

  <span class="n">solOther</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nEPECvars</span> <span class="o">-</span>        <span class="c1">// All variables in EPEC</span>
                 <span class="n">nThisCountryvars</span> <span class="o">-</span> <span class="c1">// Subtracting this country&#39;s variables,</span>
                 <span class="c1">// since we only want others&#39;</span>
                 <span class="n">nConvexHullVars</span> <span class="o">+</span> <span class="c1">// We don&#39;t want any convex hull variables</span>
                 <span class="n">nThisCountryHullVars</span><span class="p">);</span> <span class="c1">// We subtract the hull variables</span>
                                        <span class="c1">// associated to the ith player</span>
  <span class="c1">// convex hull vars, since we double subtracted</span>

  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">current</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">current</span> <span class="o">=</span> <span class="o">*</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LocEnds</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">-</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">ConvexHullVariables</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
      <span class="n">solOther</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">count</span> <span class="o">+</span> <span class="n">current</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span>
          <span class="n">x</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderLocations</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">j</span><span class="p">),</span>
                   <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderLocations</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">current</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
      <span class="n">count</span> <span class="o">+=</span> <span class="n">current</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="c1">// We need to keep track of MC_vars also for this country</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">numMCVariables</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
    <span class="n">solOther</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">solOther</span><span class="p">.</span><span class="n">n_rows</span> <span class="o">-</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">numMCVariables</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span>
        <span class="n">x</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">NumVariables</span> <span class="o">-</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">numMCVariables</span> <span class="o">+</span> <span class="n">j</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">getXofI</span><span class="p">(</span><span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">i</span><span class="p">,</span>
                         <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">solI</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">hull</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nThisCountryvars</span> <span class="o">=</span> <span class="o">*</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LocEnds</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
  <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nThisCountryHullVars</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">ConvexHullVariables</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>

  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">vars</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">current</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">hull</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">vars</span> <span class="o">=</span> <span class="n">nThisCountryvars</span><span class="p">;</span>
    <span class="n">current</span> <span class="o">=</span> <span class="o">*</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LocEnds</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">vars</span> <span class="o">=</span> <span class="n">nThisCountryvars</span> <span class="o">-</span> <span class="n">nThisCountryHullVars</span><span class="p">;</span>
    <span class="n">current</span> <span class="o">=</span> <span class="o">*</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LocEnds</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">ConvexHullVariables</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">solI</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">vars</span><span class="p">);</span>
  <span class="n">solI</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">vars</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span>
      <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderLocations</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderLocations</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">current</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">getXWithoutHull</span><span class="p">(</span><span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span>
                                 <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">xWithoutHull</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nEPECvars</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">NumVariables</span><span class="p">;</span>
  <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nConvexHullVars</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span>
      <span class="n">std</span><span class="o">::</span><span class="n">accumulate</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">ConvexHullVariables</span><span class="p">.</span><span class="n">rbegin</span><span class="p">(),</span>
                      <span class="k">this</span><span class="o">-&gt;</span><span class="n">ConvexHullVariables</span><span class="p">.</span><span class="n">rend</span><span class="p">(),</span> <span class="mi">0</span><span class="p">));</span>

  <span class="n">xWithoutHull</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nEPECvars</span> <span class="o">-</span>       <span class="c1">// All variables in EPEC</span>
                     <span class="n">nConvexHullVars</span><span class="p">);</span> <span class="c1">// We subtract the hull variables</span>
  <span class="c1">// associated to the convex hull</span>
  <span class="c1">// convex hull vars</span>

  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">current</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">current</span> <span class="o">=</span> <span class="o">*</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LocEnds</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">-</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">ConvexHullVariables</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
    <span class="n">xWithoutHull</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">count</span> <span class="o">+</span> <span class="n">current</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">subvec</span><span class="p">(</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderLocations</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderLocations</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">current</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
    <span class="n">count</span> <span class="o">+=</span> <span class="n">current</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">GRBModel</span><span class="o">&gt;</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">respond</span><span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="p">,</span>
                                              <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Finalized</span><span class="p">)</span>
    <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Error in Game::EPEC::respond: Model not Finalized&quot;</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span><span class="p">)</span>
    <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Error in Game::EPEC::respond: Invalid country number&quot;</span><span class="p">);</span>

  <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">solOther</span><span class="p">;</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">getXMinusI</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">solOther</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderObjective</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Q</span><span class="p">.</span><span class="n">n_nonzero</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PlayersLCP</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">get</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">MPECasMIQP</span><span class="p">(</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderObjective</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Q</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderObjective</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">C</span><span class="p">,</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderObjective</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">c</span><span class="p">,</span> <span class="n">solOther</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
  <span class="k">else</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PlayersLCP</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">get</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">MPECasMILP</span><span class="p">(</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderObjective</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">C</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderObjective</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">c</span><span class="p">,</span>
        <span class="n">solOther</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">double</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">respondSol</span><span class="p">(</span>
    <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">sol</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">player</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="o">&amp;</span><span class="n">prevDev</span>
    <span class="c1">//&lt; [in] if any, the std::vector of previous deviations.</span>
<span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="k">auto</span> <span class="n">model</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">respond</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
  <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::EPEC::respondSol: Writing dat/RespondSol&quot;</span> <span class="o">+</span>
                                  <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">player</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;.lp to disk&quot;</span><span class="p">;</span>
  <span class="n">model</span><span class="o">-&gt;</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;dat/RespondSol&quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">player</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;.lp&quot;</span><span class="p">);</span>
  <span class="k">const</span> <span class="kt">int</span> <span class="n">status</span> <span class="o">=</span> <span class="n">model</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">(</span><span class="n">GRB_IntAttr_Status</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">==</span> <span class="n">GRB_UNBOUNDED</span> <span class="o">||</span> <span class="n">status</span> <span class="o">==</span> <span class="n">GRB_OPTIMAL</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">Nx</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PlayersLCP</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">player</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">getNumCols</span><span class="p">();</span>
    <span class="n">sol</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nx</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">Nx</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
      <span class="n">sol</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span>
          <span class="n">model</span><span class="o">-&gt;</span><span class="n">getVarByName</span><span class="p">(</span><span class="s">&quot;x_&quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">i</span><span class="p">)).</span><span class="n">get</span><span class="p">(</span><span class="n">GRB_DoubleAttr_X</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">==</span> <span class="n">GRB_UNBOUNDED</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">warning</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::EPEC::respondSol: deviation is &quot;</span>
                                    <span class="s">&quot;unbounded.&quot;</span><span class="p">;</span>
      <span class="n">GRBLinExpr</span> <span class="n">obj</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="n">model</span><span class="o">-&gt;</span><span class="n">setObjective</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span>
      <span class="n">model</span><span class="o">-&gt;</span><span class="n">optimize</span><span class="p">();</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">prevDev</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
            <span class="o">&lt;&lt;</span> <span class="s">&quot;Generating an improvement basing on the extreme ray.&quot;</span><span class="p">;</span>
        <span class="c1">// Fetch objective function coefficients</span>
        <span class="n">GRBQuadExpr</span> <span class="n">QuadObj</span> <span class="o">=</span> <span class="n">model</span><span class="o">-&gt;</span><span class="n">getObjective</span><span class="p">();</span>
        <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">objcoeff</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">QuadObj</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
          <span class="n">objcoeff</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">QuadObj</span><span class="p">.</span><span class="n">getCoeff</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>

        <span class="c1">// Create objective function objects</span>
        <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">objvalue</span> <span class="o">=</span> <span class="n">prevDev</span> <span class="o">*</span> <span class="n">objcoeff</span><span class="p">;</span>
        <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">newobjvalue</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
        <span class="kt">bool</span> <span class="n">improved</span><span class="p">{</span><span class="nb">false</span><span class="p">};</span>

        <span class="c1">// improve following the unbounded ray</span>
        <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">improved</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">Nx</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
            <span class="n">sol</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span>
                <span class="n">sol</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">model</span><span class="o">-&gt;</span><span class="n">getVarByName</span><span class="p">(</span><span class="s">&quot;x_&quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
                                <span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">GRB_DoubleAttr_UnbdRay</span><span class="p">);</span>
          <span class="n">newobjvalue</span> <span class="o">=</span> <span class="n">sol</span> <span class="o">*</span> <span class="n">objcoeff</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">newobjvalue</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">objvalue</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            <span class="n">improved</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">newobjvalue</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">model</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">(</span><span class="n">GRB_DoubleAttr_ObjVal</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">==</span> <span class="n">GRB_OPTIMAL</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">model</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">(</span><span class="n">GRB_DoubleAttr_ObjVal</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">GRB_INFINITY</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">GRB_INFINITY</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">const</span> <span class="kt">void</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">makePlayerQP</span><span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// BOOST_LOG_TRIVIAL(info) &lt;&lt; &quot;Starting Convex hull computation of the country</span>
  <span class="c1">// &quot;</span>
  <span class="c1">// &lt;&lt; this-&gt;AllLeadPars[i].name &lt;&lt; &#39;\n&#39;;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Finalized</span><span class="p">)</span>
    <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Error in Game::EPEC::makePlayerQP: Model not Finalized&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span><span class="p">)</span>
    <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Error in Game::EPEC::makePlayerQP: Invalid country number&quot;</span><span class="p">);</span>
  <span class="c1">// if (!this-&gt;PlayersQP.at(i).get())</span>
  <span class="p">{</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">PlayersQP</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">Game</span><span class="o">::</span><span class="n">QP_Param</span><span class="o">&gt;</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Env</span><span class="p">);</span>
    <span class="k">const</span> <span class="k">auto</span> <span class="o">&amp;</span><span class="n">origLeadObjec</span> <span class="o">=</span> <span class="o">*</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderObjective</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">get</span><span class="p">();</span>

    <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderObjectiveConvexHull</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">reset</span><span class="p">(</span><span class="k">new</span> <span class="n">Game</span><span class="o">::</span><span class="n">QP_Objective</span><span class="p">{</span>
        <span class="n">origLeadObjec</span><span class="p">.</span><span class="n">Q</span><span class="p">,</span> <span class="n">origLeadObjec</span><span class="p">.</span><span class="n">C</span><span class="p">,</span> <span class="n">origLeadObjec</span><span class="p">.</span><span class="n">c</span><span class="p">});</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">PlayersLCP</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">makeQP</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderObjectiveConvexHull</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">get</span><span class="p">(),</span>
                                   <span class="o">*</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">PlayersQP</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">get</span><span class="p">());</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">makePlayersQPs</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">makePlayerQP</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// LeadLocs &amp;Loc = this-&gt;Locations.at(i);</span>
    <span class="c1">// Adjusting &quot;stuff&quot; because we now have new convHull variables</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">originalSizeWithoutHull</span> <span class="o">=</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderObjective</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Q</span><span class="p">.</span><span class="n">n_rows</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">convHullVarCount</span> <span class="o">=</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">LeaderObjectiveConvexHull</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Q</span><span class="p">.</span><span class="n">n_rows</span> <span class="o">-</span>
        <span class="n">originalSizeWithoutHull</span><span class="p">;</span>

    <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::EPEC::makePlayerQP: Added &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">convHullVarCount</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot; convex hull variables to QP #&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">;</span>

    <span class="c1">// Location details</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">ConvexHullVariables</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">convHullVarCount</span><span class="p">;</span>
    <span class="c1">// All other players&#39; QP</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="o">-&gt;</span><span class="n">PlayersQP</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">addDummy</span><span class="p">(</span>
                <span class="n">convHullVarCount</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                <span class="k">this</span><span class="o">-&gt;</span><span class="n">PlayersQP</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">getNx</span><span class="p">()</span> <span class="o">-</span>
                    <span class="k">this</span><span class="o">-&gt;</span><span class="n">numMCVariables</span><span class="p">);</span> <span class="c1">// The position to add parameters is</span>
                                           <span class="c1">// towards the end of all parameters,</span>
                                           <span class="c1">// giving space only for the</span>
                                           <span class="c1">// numMCVariables number of market</span>
                                           <span class="c1">// clearing variables</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="n">e</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
      <span class="k">throw</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;String in Game::EPEC::makePlayerQP : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
      <span class="k">throw</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">GRBException</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;GRBException in Game::EPEC::makePlayerQP : &quot;</span>
                <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="n">getErrorCode</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="n">getMessage</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
      <span class="k">throw</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">exception</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Exception in Game::EPEC::makePlayerQP : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">()</span>
                <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
      <span class="k">throw</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">updateLocations</span><span class="p">();</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">computeLeaderLocations</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">numMCVariables</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="o">::</span><span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">makeTheLCP</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">PlayersQP</span><span class="p">.</span><span class="n">front</span><span class="p">()</span> <span class="o">==</span> <span class="k">nullptr</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Exception in Game::EPEC::makeTheLCP : &quot;</span>
                                <span class="s">&quot;no country QP has been &quot;</span>
                                <span class="s">&quot;made.&quot;</span>
                             <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">// Preliminary set up to get the LCP ready</span>
  <span class="kt">int</span> <span class="n">Nvar</span> <span class="o">=</span>
      <span class="k">this</span><span class="o">-&gt;</span><span class="n">PlayersQP</span><span class="p">.</span><span class="n">front</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">getNx</span><span class="p">()</span> <span class="o">+</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PlayersQP</span><span class="p">.</span><span class="n">front</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">getNy</span><span class="p">();</span>
  <span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span> <span class="n">MC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Nvar</span><span class="p">),</span> <span class="n">dumA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Nvar</span><span class="p">);</span>
  <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">MCRHS</span><span class="p">,</span> <span class="n">dumb</span><span class="p">;</span>
  <span class="n">MCRHS</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">dumb</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">makeMCConstraints</span><span class="p">(</span><span class="n">MC</span><span class="p">,</span> <span class="n">MCRHS</span><span class="p">);</span>
  <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::EPEC::makeTheLCP(): Market Clearing &quot;</span>
                              <span class="s">&quot;constraints are ready&quot;</span><span class="p">;</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">TheNashGame</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Game</span><span class="o">::</span><span class="n">NashGame</span><span class="o">&gt;</span><span class="p">(</span>
      <span class="k">new</span> <span class="n">Game</span><span class="o">::</span><span class="n">NashGame</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Env</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PlayersQP</span><span class="p">,</span> <span class="n">MC</span><span class="p">,</span> <span class="n">MCRHS</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dumA</span><span class="p">,</span> <span class="n">dumb</span><span class="p">));</span>
  <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::EPEC::makeTheLCP(): NashGame is ready&quot;</span><span class="p">;</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">TheLCP</span> <span class="o">=</span>
      <span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Game</span><span class="o">::</span><span class="n">LCP</span><span class="o">&gt;</span><span class="p">(</span><span class="k">new</span> <span class="n">Game</span><span class="o">::</span><span class="n">LCP</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Env</span><span class="p">,</span> <span class="o">*</span><span class="n">TheNashGame</span><span class="p">));</span>
  <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::EPEC::makeTheLCP(): LCP is ready&quot;</span><span class="p">;</span>
  <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::EPEC::makeTheLCP(): Indicators set to &quot;</span>
                           <span class="o">&lt;&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="p">.</span><span class="n">AlgorithmParam</span><span class="p">.</span><span class="n">Indicators</span><span class="p">;</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">TheLCP</span><span class="o">-&gt;</span><span class="n">UseIndicators</span> <span class="o">=</span>
      <span class="k">this</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="p">.</span><span class="n">AlgorithmParam</span><span class="p">.</span><span class="n">Indicators</span><span class="p">;</span> <span class="c1">// Using indicator constraints</span>

  <span class="k">this</span><span class="o">-&gt;</span><span class="n">LCPModel</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">TheLCP</span><span class="o">-&gt;</span><span class="n">LCPasMIP</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
  <span class="c1">//this-&gt;LCPModel-&gt;setObjective(GRBLinExpr{0}, GRB_MINIMIZE);</span>

  <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="o">*</span><span class="n">TheNashGame</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">computeNashEq</span><span class="p">(</span>
    <span class="kt">bool</span> <span class="n">pureNE</span><span class="p">,</span>
    <span class="kt">double</span> <span class="n">localTimeLimit</span><span class="p">,</span>
    <span class="kt">bool</span> <span class="n">check</span>
<span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Make the Nash Game between countries</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">NashEquilibrium</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
  <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
      <span class="o">&lt;&lt;</span> <span class="s">&quot; Game::EPEC::computeNashEq: Making the Master LCP&quot;</span><span class="p">;</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">makeTheLCP</span><span class="p">();</span>
  <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; Game::EPEC::computeNashEq: Made the Master LCP&quot;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">localTimeLimit</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">LCPModel</span><span class="o">-&gt;</span><span class="n">set</span><span class="p">(</span><span class="n">GRB_DoubleParam_TimeLimit</span><span class="p">,</span> <span class="n">localTimeLimit</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="p">.</span><span class="n">AlgorithmParam</span><span class="p">.</span><span class="n">BoundPrimals</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">TheNashGame</span><span class="o">-&gt;</span><span class="n">getNprimals</span><span class="p">();</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="o">-&gt;</span><span class="n">LCPModel</span><span class="o">-&gt;</span><span class="n">getVarByName</span><span class="p">(</span><span class="s">&quot;x_&quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
          <span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">GRB_DoubleAttr_UB</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="p">.</span><span class="n">AlgorithmParam</span><span class="p">.</span><span class="n">BoundBigM</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">pureNE</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot; Game::EPEC::computeNashEq: (PureNashEquilibrium flag is &quot;</span>
           <span class="s">&quot;true) Searching for a pure NE.&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="p">.</span><span class="n">AlgorithmParam</span><span class="p">.</span><span class="n">PolyLcp</span><span class="p">)</span>
      <span class="k">dynamic_cast</span><span class="o">&lt;</span><span class="n">Algorithms</span><span class="o">::</span><span class="n">PolyBase</span> <span class="o">*&gt;</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Algorithm</span><span class="p">.</span><span class="n">get</span><span class="p">())</span>
          <span class="o">-&gt;</span><span class="n">makeThePureLCP</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="p">.</span><span class="n">AlgorithmParam</span><span class="p">.</span><span class="n">Indicators</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">this</span><span class="o">-&gt;</span><span class="n">LCPModel</span><span class="o">-&gt;</span><span class="n">set</span><span class="p">(</span><span class="n">GRB_IntParam_OutputFlag</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">check</span><span class="p">)</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">LCPModel</span><span class="o">-&gt;</span><span class="n">set</span><span class="p">(</span><span class="n">GRB_IntParam_SolutionLimit</span><span class="p">,</span> <span class="n">GRB_MAXINT</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">LCPModel</span><span class="o">-&gt;</span><span class="n">optimize</span><span class="p">();</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="p">.</span><span class="n">WallClockTime</span> <span class="o">+=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LCPModel</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">(</span><span class="n">GRB_DoubleAttr_Runtime</span><span class="p">);</span>

  <span class="c1">// Search just for a feasible point</span>
  <span class="k">try</span> <span class="p">{</span> <span class="c1">// Try finding a Nash equilibrium for the approximation</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">NashEquilibrium</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">TheLCP</span><span class="o">-&gt;</span><span class="n">extractSols</span><span class="p">(</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">LCPModel</span><span class="p">.</span><span class="n">get</span><span class="p">(),</span> <span class="n">SolutionZ</span><span class="p">,</span> <span class="n">SolutionX</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">GRBException</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;GRBException in Game::EPEC::computeNashEq : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="n">getErrorCode</span><span class="p">()</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="n">getMessage</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">NashEquilibrium</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// If a Nash equilibrium is found, then update</span>
    <span class="c1">// appropriately</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">check</span><span class="p">)</span> <span class="p">{</span>
      <span class="kt">int</span> <span class="n">scount</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LCPModel</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">(</span><span class="n">GRB_IntAttr_SolCount</span><span class="p">);</span>
      <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
          <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::EPEC::computeNashEq: number of equilibria is &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">scount</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">scount</span> <span class="o">&amp;&amp;</span> <span class="n">stop</span> <span class="o">==</span> <span class="mi">0</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">LCPModel</span><span class="o">-&gt;</span><span class="n">getEnv</span><span class="p">().</span><span class="n">set</span><span class="p">(</span><span class="n">GRB_IntParam_SolutionNumber</span><span class="p">,</span> <span class="n">k</span><span class="p">);</span>
        <span class="k">this</span><span class="o">-&gt;</span><span class="n">NashEquilibrium</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">TheLCP</span><span class="o">-&gt;</span><span class="n">extractSols</span><span class="p">(</span>
            <span class="k">this</span><span class="o">-&gt;</span><span class="n">LCPModel</span><span class="p">.</span><span class="n">get</span><span class="p">(),</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">SolutionZ</span><span class="p">,</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">SolutionX</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Algorithm</span><span class="o">-&gt;</span><span class="n">isSolved</span><span class="p">())</span> <span class="p">{</span>
          <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
              <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::EPEC::computeNashEq: an Equilibrium has been found&quot;</span><span class="p">;</span>
          <span class="n">stop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">this</span><span class="o">-&gt;</span><span class="n">NashEquilibrium</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
      <span class="k">this</span><span class="o">-&gt;</span><span class="n">SolutionX</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">&quot;dat/X.dat&quot;</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">file_type</span><span class="o">::</span><span class="n">arma_ascii</span><span class="p">);</span>
      <span class="k">this</span><span class="o">-&gt;</span><span class="n">SolutionZ</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">&quot;dat/Z.dat&quot;</span><span class="p">,</span> <span class="n">arma</span><span class="o">::</span><span class="n">file_type</span><span class="o">::</span><span class="n">arma_ascii</span><span class="p">);</span>
      <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
          <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::EPEC::computeNashEq: an Equilibrium has been found&quot;</span><span class="p">;</span>
    <span class="p">}</span>

  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// If not, then update accordingly</span>
    <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::EPEC::computeNashEq: no equilibrium has been found.&quot;</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">status</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LCPModel</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">(</span><span class="n">GRB_IntAttr_Status</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">==</span> <span class="n">GRB_TIME_LIMIT</span><span class="p">)</span>
      <span class="k">this</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="p">.</span><span class="n">Status</span> <span class="o">=</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECsolveStatus</span><span class="o">::</span><span class="n">TimeLimit</span><span class="p">;</span>
    <span class="k">else</span>
      <span class="k">this</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="p">.</span><span class="n">Status</span> <span class="o">=</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECsolveStatus</span><span class="o">::</span><span class="n">NashEqNotFound</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">NashEquilibrium</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">warmstart</span><span class="p">(</span><span class="k">const</span> <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//@todo complete implementation</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">getNumVar</span><span class="p">())</span> <span class="p">{</span>
    <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;Exception in Game::EPEC::warmstart: number of variables &quot;</span>
           <span class="s">&quot;does not fit this instance.&quot;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Finalized</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;Exception in Game::EPEC::warmstart: EPEC is not Finalized.&quot;</span><span class="p">;</span>
    <span class="k">throw</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">PlayersQP</span><span class="p">.</span><span class="n">front</span><span class="p">()</span> <span class="o">==</span> <span class="k">nullptr</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">warning</span><span class="p">)</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::EPEC::warmstart: Generating QP as of warmstart.&quot;</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">this</span><span class="o">-&gt;</span><span class="n">SolutionX</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">arma</span><span class="o">::</span><span class="n">vec</span><span class="o">&gt;</span> <span class="n">devns</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">arma</span><span class="o">::</span><span class="n">vec</span><span class="o">&gt;</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span><span class="p">);</span>
  <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">arma</span><span class="o">::</span><span class="n">vec</span><span class="o">&gt;</span> <span class="n">prevDevns</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">arma</span><span class="o">::</span><span class="n">vec</span><span class="o">&gt;</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">NumPlayers</span><span class="p">);</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">makePlayersQPs</span><span class="p">();</span>

  <span class="n">arma</span><span class="o">::</span><span class="n">vec</span> <span class="n">devn</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Algorithm</span><span class="o">-&gt;</span><span class="n">isSolved</span><span class="p">())</span>
    <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">warning</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::EPEC::warmstart: &quot;</span>
                                  <span class="s">&quot;The loaded solution is optimal.&quot;</span><span class="p">;</span>
  <span class="k">else</span>
    <span class="nf">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">warning</span><span class="p">)</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::EPEC::warmstart: &quot;</span>
           <span class="s">&quot;The loaded solution is NOT optimal. Trying to repair.&quot;</span><span class="p">;</span>
  <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">bool</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">isPureStrategy</span><span class="p">(</span><span class="kt">double</span> <span class="n">tol</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Algorithm</span><span class="o">-&gt;</span><span class="n">isPureStrategy</span><span class="p">(</span><span class="n">tol</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">bool</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">isSolved</span><span class="p">(</span><span class="kt">double</span> <span class="n">tol</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">Algorithm</span><span class="o">-&gt;</span><span class="n">isSolved</span><span class="p">(</span><span class="n">tol</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">const</span> <span class="kt">void</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">findNashEq</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">stringstream</span> <span class="n">final_msg</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Finalized</span><span class="p">)</span>
    <span class="k">throw</span><span class="p">(</span><span class="s">&quot;Error in Game::EPEC::iterativeNash: Object not yet &quot;</span>
          <span class="s">&quot;Finalized. &quot;</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="p">.</span><span class="n">Status</span> <span class="o">!=</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECsolveStatus</span><span class="o">::</span><span class="n">Uninitialized</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::EPEC::findNashEq: a Nash Eq was &quot;</span>
           <span class="s">&quot;already found. Calling this findNashEq might lead to errors!&quot;</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Choosing the appropriate algorithm</span>
  <span class="k">switch</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="p">.</span><span class="n">AlgorithmParam</span><span class="p">.</span><span class="n">Algorithm</span><span class="p">)</span> <span class="p">{</span>

  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECalgorithm</span><span class="o">::</span><span class="nl">InnerApproximation</span><span class="p">:</span> <span class="p">{</span>
    <span class="n">final_msg</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Inner approximation Algorithm completed. &quot;</span><span class="p">;</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">Algorithm</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Algorithms</span><span class="o">::</span><span class="n">Algorithm</span><span class="o">&gt;</span><span class="p">(</span>
        <span class="k">new</span> <span class="k">class</span> <span class="nc">Algorithms</span><span class="o">::</span><span class="n">InnerApproximation</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Env</span><span class="p">,</span> <span class="k">this</span><span class="p">));</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">Algorithm</span><span class="o">-&gt;</span><span class="n">solve</span><span class="p">();</span>
  <span class="p">}</span> <span class="k">break</span><span class="p">;</span>

  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECalgorithm</span><span class="o">::</span><span class="nl">CombinatorialPne</span><span class="p">:</span> <span class="p">{</span>
    <span class="n">final_msg</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;CombinatorialPNE Algorithm completed. &quot;</span><span class="p">;</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">Algorithm</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Algorithms</span><span class="o">::</span><span class="n">Algorithm</span><span class="o">&gt;</span><span class="p">(</span>
        <span class="k">new</span> <span class="k">class</span> <span class="nc">Algorithms</span><span class="o">::</span><span class="n">CombinatorialPNE</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Env</span><span class="p">,</span> <span class="k">this</span><span class="p">));</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">Algorithm</span><span class="o">-&gt;</span><span class="n">solve</span><span class="p">();</span>
  <span class="p">}</span> <span class="k">break</span><span class="p">;</span>

  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECalgorithm</span><span class="o">::</span><span class="nl">OuterApproximation</span><span class="p">:</span> <span class="p">{</span>
    <span class="n">final_msg</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Outer approximation Algorithm completed. &quot;</span><span class="p">;</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">Algorithm</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Algorithms</span><span class="o">::</span><span class="n">Algorithm</span><span class="o">&gt;</span><span class="p">(</span>
        <span class="k">new</span> <span class="k">class</span> <span class="nc">Algorithms</span><span class="o">::</span><span class="n">OuterApproximation</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Env</span><span class="p">,</span> <span class="k">this</span><span class="p">));</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">Algorithm</span><span class="o">-&gt;</span><span class="n">solve</span><span class="p">();</span>
  <span class="p">}</span> <span class="k">break</span><span class="p">;</span>

  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECalgorithm</span><span class="o">::</span><span class="nl">FullEnumeration</span><span class="p">:</span> <span class="p">{</span>
    <span class="n">final_msg</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Full enumeration Algorithm completed. &quot;</span><span class="p">;</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">Algorithm</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Algorithms</span><span class="o">::</span><span class="n">Algorithm</span><span class="o">&gt;</span><span class="p">(</span>
        <span class="k">new</span> <span class="k">class</span> <span class="nc">Algorithms</span><span class="o">::</span><span class="n">FullEnumeration</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Env</span><span class="p">,</span> <span class="k">this</span><span class="p">));</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">Algorithm</span><span class="o">-&gt;</span><span class="n">solve</span><span class="p">();</span>
  <span class="p">}</span> <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">// Handing EPECStatistics object to track performance of algorithm</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LCPModel</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="p">.</span><span class="n">NumVar</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LCPModel</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">(</span><span class="n">GRB_IntAttr_NumVars</span><span class="p">);</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="p">.</span><span class="n">NumConstraints</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LCPModel</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">(</span><span class="n">GRB_IntAttr_NumConstrs</span><span class="p">);</span>
    <span class="k">this</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="p">.</span><span class="n">NumNonZero</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LCPModel</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">(</span><span class="n">GRB_IntAttr_NumNZs</span><span class="p">);</span>
  <span class="p">}</span> <span class="c1">// Assigning appropriate Status messages after solving</span>

  <span class="k">switch</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="p">.</span><span class="n">Status</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECsolveStatus</span><span class="o">::</span><span class="nl">NashEqNotFound</span><span class="p">:</span>
    <span class="n">final_msg</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;No Nash equilibrium exists.&quot;</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECsolveStatus</span><span class="o">::</span><span class="nl">NashEqFound</span><span class="p">:</span> <span class="p">{</span>
    <span class="n">final_msg</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Found a Nash equilibrium (&quot;</span>
              <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="p">.</span><span class="n">PureNashEquilibrium</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="s">&quot;MNE&quot;</span> <span class="o">:</span> <span class="s">&quot;PNE&quot;</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;).&quot;</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECsolveStatus</span><span class="o">::</span><span class="nl">TimeLimit</span><span class="p">:</span>
    <span class="n">final_msg</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Nash equilibrium not found. Time limit attained&quot;</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECsolveStatus</span><span class="o">::</span><span class="nl">Numerical</span><span class="p">:</span>
    <span class="n">final_msg</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Nash equilibrium not found. Numerical issues might affect &quot;</span>
                 <span class="s">&quot;this result.&quot;</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="k">default</span><span class="o">:</span>
    <span class="n">final_msg</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Nash equilibrium not found. Time limit attained&quot;</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">BOOST_LOG_TRIVIAL</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Game::EPEC::findNashEq: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">final_msg</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">setAlgorithm</span><span class="p">(</span><span class="n">Game</span><span class="o">::</span><span class="n">EPECalgorithm</span> <span class="n">algorithm</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="p">.</span><span class="n">AlgorithmParam</span><span class="p">.</span><span class="n">Algorithm</span> <span class="o">=</span> <span class="n">algorithm</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">setRecoverStrategy</span><span class="p">(</span><span class="n">Game</span><span class="o">::</span><span class="n">EPECRecoverStrategy</span> <span class="n">strategy</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">this</span><span class="o">-&gt;</span><span class="n">Stats</span><span class="p">.</span><span class="n">AlgorithmParam</span><span class="p">.</span><span class="n">RecoverStrategy</span> <span class="o">=</span> <span class="n">strategy</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">getPositionLeadFoll</span><span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="p">,</span>
                                             <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">j</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="k">const</span> <span class="k">auto</span> <span class="n">LeaderStart</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">TheNashGame</span><span class="o">-&gt;</span><span class="n">getPrimalLoc</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">LeaderStart</span> <span class="o">+</span> <span class="n">j</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">getPositionLeadLead</span><span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="p">,</span>
                                             <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">j</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="k">const</span> <span class="k">auto</span> <span class="n">LeaderStart</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">TheNashGame</span><span class="o">-&gt;</span><span class="n">getPrimalLoc</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">LeaderStart</span> <span class="o">+</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">PlayersLCP</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">getLStart</span><span class="p">()</span> <span class="o">+</span> <span class="n">j</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">double</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">getValLeadFoll</span><span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="p">,</span>
                                  <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">j</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LCPModel</span><span class="p">)</span>
    <span class="k">throw</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;Error in Game::EPEC::getValLeadFoll: &quot;</span>
                      <span class="s">&quot;Game::EPEC::LCPModel not made and solved&quot;</span><span class="p">);</span>
  <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LCPModel</span>
      <span class="o">-&gt;</span><span class="n">getVarByName</span><span class="p">(</span><span class="s">&quot;x_&quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">getPositionLeadFoll</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
      <span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">GRB_DoubleAttr_X</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">double</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPEC</span><span class="o">::</span><span class="n">getValLeadLead</span><span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="p">,</span>
                                  <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">j</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">LCPModel</span><span class="p">)</span>
    <span class="k">throw</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;Error in Game::EPEC::getValLeadLead: &quot;</span>
                      <span class="s">&quot;Game::EPEC::LCPModel not made and solved&quot;</span><span class="p">);</span>
  <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">LCPModel</span>
      <span class="o">-&gt;</span><span class="n">getVarByName</span><span class="p">(</span><span class="s">&quot;x_&quot;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">getPositionLeadLead</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
      <span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">GRB_DoubleAttr_X</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="k">const</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECsolveStatus</span> <span class="n">st</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="n">st</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECsolveStatus</span><span class="o">::</span><span class="nl">NashEqNotFound</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;NO_NASH_EQ_FOUND&quot;</span><span class="p">);</span>
  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECsolveStatus</span><span class="o">::</span><span class="nl">NashEqFound</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;NASH_EQ_FOUND&quot;</span><span class="p">);</span>
  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECsolveStatus</span><span class="o">::</span><span class="nl">TimeLimit</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;TIME_LIMIT&quot;</span><span class="p">);</span>
  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECsolveStatus</span><span class="o">::</span><span class="nl">Uninitialized</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;UNINITIALIZED&quot;</span><span class="p">);</span>
  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECsolveStatus</span><span class="o">::</span><span class="nl">Numerical</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;NUMERICAL_ISSUES&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="k">const</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECalgorithm</span> <span class="n">al</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="n">al</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECalgorithm</span><span class="o">::</span><span class="nl">FullEnumeration</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;FullEnumeration&quot;</span><span class="p">);</span>
  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECalgorithm</span><span class="o">::</span><span class="nl">InnerApproximation</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;InnerApproximation&quot;</span><span class="p">);</span>
  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECalgorithm</span><span class="o">::</span><span class="nl">CombinatorialPne</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;CombinatorialPNE&quot;</span><span class="p">);</span>
  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECalgorithm</span><span class="o">::</span><span class="nl">OuterApproximation</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;OuterApproximation&quot;</span><span class="p">);</span>
  <span class="k">default</span><span class="o">:</span>
    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;UNKNOWN_ALGORITHM_&quot;</span><span class="p">)</span> <span class="o">+</span>
           <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">al</span><span class="p">));</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="k">const</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECRecoverStrategy</span> <span class="n">strategy</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="n">strategy</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECRecoverStrategy</span><span class="o">::</span><span class="nl">IncrementalEnumeration</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;IncrementalEnumeration&quot;</span><span class="p">);</span>
  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECRecoverStrategy</span><span class="o">::</span><span class="nl">Combinatorial</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;Combinatorial&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="k">const</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECAddPolyMethod</span> <span class="n">add</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="n">add</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECAddPolyMethod</span><span class="o">::</span><span class="nl">Sequential</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;Sequential&quot;</span><span class="p">);</span>
  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECAddPolyMethod</span><span class="o">::</span><span class="nl">ReverseSequential</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;ReverseSequential&quot;</span><span class="p">);</span>
  <span class="k">case</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECAddPolyMethod</span><span class="o">::</span><span class="nl">Random</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;Random&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="k">const</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECAlgorithmParams</span> <span class="n">al</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">stringstream</span> <span class="n">ss</span><span class="p">;</span>
  <span class="n">ss</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Algorithm: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">al</span><span class="p">.</span><span class="n">Algorithm</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">al</span><span class="p">.</span><span class="n">Algorithm</span> <span class="o">==</span> <span class="n">Game</span><span class="o">::</span><span class="n">EPECalgorithm</span><span class="o">::</span><span class="n">InnerApproximation</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ss</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Aggressiveness: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">al</span><span class="p">.</span><span class="n">Aggressiveness</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
    <span class="n">ss</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;AddPolyMethod: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">al</span><span class="p">.</span><span class="n">AddPolyMethod</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">ss</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Time Limit: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">al</span><span class="p">.</span><span class="n">TimeLimit</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
  <span class="n">ss</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Indicators: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">boolalpha</span> <span class="o">&lt;&lt;</span> <span class="n">al</span><span class="p">.</span><span class="n">Indicators</span><span class="p">;</span>

  <span class="k">return</span> <span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, GD and SS

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>